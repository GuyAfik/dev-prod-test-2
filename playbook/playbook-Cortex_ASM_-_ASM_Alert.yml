contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: 6.10.0
    itemVersion: 1.7.64
    packID: CortexAttackSurfaceManagement
    packName: Cortex Attack Surface Management
    packPropagationLabels:
    - all
    prevname: ""
    propagationLabels: []
    toServerVersion: ""
description: This playbook handles ASM alerts by enriching asset information and providing
  a means of remediating the issue directly or through contacting service owners.
id: Cortex ASM - ASM Alert
inputSections:
- description: Generic group for inputs
  inputs:
  - OwnerNotificationSubject
  - OwnerNotificationBody
  - NotificationTicketType
  - RemediationNotificationSubject
  - RemediationNotificationHTMLBody
  - BypassDevCheck
  - AcceptedRiskIDs
  - AcceptedRiskProjects
  - AcceptedRiskOther
  - JiraProjectKey
  - AWSAssumeRoleName
  - InstantMessageChannel
  name: General (Inputs group)
inputs:
- description: Subject of the notification (email or ticket) sent to potential service
    owner.
  key: OwnerNotificationSubject
  playbookInputQuery: null
  required: true
  value:
    simple: A new security risk was identified on an external service owned by your
      team
- description: Body of the notification (email or ticket) sent to potential service
    owner.
  key: OwnerNotificationBody
  playbookInputQuery: null
  required: true
  value:
    simple: |+
      Infosec identified a security risk on an external service potentially owned by your team: ${alert.name}<br><br>

      Description: ${alert.details}
      <br><br>

- description: The ticket type used by ticketing systems. The default is "incident"
    because ticketing systems such as ServiceNow and Cherwell use it as default.
  key: NotificationTicketType
  playbookInputQuery: null
  required: true
  value:
    simple: alert
- description: Subject of the notification (email or ticket) sent to the service owner
    after remediation.
  key: RemediationNotificationSubject
  playbookInputQuery: null
  required: true
  value:
    simple: A new security risk was addressed on an external service owned by your
      team
- description: Body of the notification (email or ticket) sent to the service owner
    after remediation.
  key: RemediationNotificationHTMLBody
  playbookInputQuery: null
  required: true
  value:
    simple: |-
      <!DOCTYPE html>
      <html lang="en">
      <body>
          <p>
              Infosec identified a security risk on an external service potentially owned by your
              team:<br><b>${alert.name}</b>
          </p>
          <p>
              <b>Alert Details:</b> ${alert.details}<br>
              <b>Action Taken:</b> ${alert.asmremediation.[0].action}<br>
              <b>Action Outcome:</b> ${alert.asmremediation.[0].outcome}<br>
          </p>
      </body>
      </html>
- description: |-
    Determine whether to bypass the Dev Check in automated remediation criteria: https://docs-cortex.paloaltonetworks.com/r/Cortex-XPANSE/Cortex-Xpanse-Expander-User-Guide/Automated-Remediation-Capabilities-Matrix

    Set to "True" if you want to bypass.  Default is "False".
  key: BypassDevCheck
  playbookInputQuery: null
  required: false
  value:
    simple: "False"
- description: Comma-separated list of instance/VM IDs that are considered an accepted
    risk and that should be closed.
  key: AcceptedRiskIDs
  playbookInputQuery: null
  required: false
  value: {}
- description: Comma-separated list of projects numbers that are considered an accepted
    risk and that should be closed.  For example, a list of GCP projects, names of
    Azure Resource Groups, and AWS accounts.
  key: AcceptedRiskProjects
  playbookInputQuery: null
  required: false
  value: {}
- description: Comma-separated list of other items that are considered an accepted
    risk and that should be closed. For example, a list of folders numbers in GCP
    and subscription IDs in Azure.
  key: AcceptedRiskOther
  playbookInputQuery: null
  required: false
  value: {}
- description: The Jira project key to associate with the issue.
  key: JiraProjectKey
  playbookInputQuery: null
  required: true
  value: {}
- description: If assuming roles for AWS, this is the name of the role to assume (should
    be the same for all organizations).
  key: AWSAssumeRoleName
  playbookInputQuery: null
  required: false
  value: {}
- description: Channel to send instant messages for notification purposes.  For Slack,
    this will be the channel ID.
  key: InstantMessageChannel
  playbookInputQuery: null
  required: false
  value: {}
name: Cortex ASM - ASM Alert
outputSections:
- description: Generic group for outputs
  name: General (Outputs group)
  outputs: []
outputs: []
starttaskid: "0"
system: true
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "5"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: b7b07d0b-fee5-4b51-8e6b-928088c82c42
      iscommand: false
      name: ""
      version: -1
    taskid: b7b07d0b-fee5-4b51-8e6b-928088c82c42
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 70,
          "y": -1780
        }
      }
  "4":
    continueonerrortype: ""
    id: "4"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: c300597e-a947-4a0e-8551-7e862c5caa53
      iscommand: false
      name: Complete
      type: title
      version: -1
    taskid: c300597e-a947-4a0e-8551-7e862c5caa53
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 70,
          "y": 5260
        }
      }
  "5":
    continueonerrortype: ""
    id: "5"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "180"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: c77b9c64-6bba-4ba5-85b5-726d41384dab
      iscommand: false
      name: Triage and Qualifier Stage
      type: title
      version: -1
    taskid: c77b9c64-6bba-4ba5-85b5-726d41384dab
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 70,
          "y": -1640
        }
      }
  "6":
    continueonerrortype: ""
    id: "6"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "185"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 6e545db5-41cc-4414-8755-1094a1c03fe8
      iscommand: false
      name: Enrichment Stage
      type: title
      version: -1
    taskid: 6e545db5-41cc-4414-8755-1094a1c03fe8
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 70,
          "y": -1000
        }
      }
  "8":
    continueonerrortype: ""
    id: "8"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "186"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 1b80b617-5189-4039-8315-7b11be105d7d
      iscommand: false
      name: Decision Stage
      type: title
      version: -1
    taskid: 1b80b617-5189-4039-8315-7b11be105d7d
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 70,
          "y": 330
        }
      }
  "10":
    continueonerrortype: ""
    id: "10"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "179"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 4a19c6fd-f41a-40d5-87b9-811c1235dc71
      iscommand: false
      name: Notification Stage
      type: title
      version: -1
    taskid: 4a19c6fd-f41a-40d5-87b9-811c1235dc71
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 690,
          "y": 1610
        }
      }
  "11":
    continueonerrortype: ""
    id: "11"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "86"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Send an email.
      id: b149b6cb-541e-45b8-8b18-27fecce33932
      iscommand: false
      name: Validation Stage
      type: title
      version: -1
    taskid: b149b6cb-541e-45b8-8b18-27fecce33932
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 70,
          "y": 3055
        }
      }
  "12":
    continueonerrortype: ""
    id: "12"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "187"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: e70c7cd7-c4d1-4f49-8ca1-8d1522da9d6a
      iscommand: false
      name: Remediation Stage
      type: title
      version: -1
    taskid: e70c7cd7-c4d1-4f49-8ca1-8d1522da9d6a
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -690,
          "y": 1540
        }
      }
  "13":
    continueonerrortype: ""
    id: "13"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "177"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: e460ad6f-77f0-4911-887d-9954b478ff75
      iscommand: false
      name: Summarization Stage
      type: title
      version: -1
    taskid: e460ad6f-77f0-4911-887d-9954b478ff75
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 70,
          "y": 3855
        }
      }
  "20":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: scanresult
                root: alert.asmservicedetection
                transformers:
                - operator: LastArrayElement
          operator: isEqualString
          right:
            value:
              simple: REMEDIATED
        - left:
            iscontext: true
            value:
              complex:
                accessor: outcome
                root: alert.asmremediation
          operator: isEqualString
          right:
            value:
              simple: Success
      label: "no"
    continueonerrortype: ""
    id: "20"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "21"
      "no":
      - "135"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Determines if service was still observable and also if automated
        remediation was done.
      id: c428c373-5c79-44cb-80e7-de555c354c34
      iscommand: false
      name: Service exposure still observable?
      type: condition
      version: -1
    taskid: c428c373-5c79-44cb-80e7-de555c354c34
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 70,
          "y": 3350
        }
      }
  "21":
    continueonerrortype: ""
    form:
      description: The post migration Remediation Confirmation Scan wasn't conclusive.
        Decide the next steps.
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: If you know the issue has been remediated, choose to keep open and
            have next Xpanse scan auto-close or manually close now.
        options: []
        optionsarg:
        - simple: Close Now
        - simple: Wait to Auto-close
        placeholder: ""
        readonly: false
        required: false
        tooltip: ""
        type: singleSelect
      sender: Your SOC team
      title: Select a next step
      totalanswers: 0
    id: "21"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body:
        simple: The post migration NMAP scan wasn't conclusive, decide next steps.
      cc: null
      format: ""
      methods: []
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      '#none#':
      - "135"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Determines if alert should be closed or kept open for auto-closure
        based on analyst input.
      id: 2076296d-2bfe-4b4c-8cdf-7bb538290e97
      iscommand: false
      name: What to do if Remediation Confirmation Scan is inconclusive?
      type: collection
      version: -1
    taskid: 2076296d-2bfe-4b4c-8cdf-7bb538290e97
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 310,
          "y": 3530
        }
      }
  "48":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: selected
                root: alert.asmdatacollection
          operator: isEqualString
          right:
            value:
              simple: Automated remediation by restricting open ports
        - left:
            iscontext: true
            value:
              complex:
                accessor: selected
                root: alert.asmdatacollection
          operator: isEqualString
          right:
            value:
              simple: Automated remediation by isolating the endpoint on the network
        - left:
            iscontext: true
            value:
              complex:
                accessor: selected
                root: alert.asmdatacollection
          operator: isEqualString
          right:
            value:
              simple: Automated remediation by creating empty S3 bucket
        - left:
            iscontext: true
            value:
              simple: alert.asmdatacollection.selected
          operator: isEqualString
          right:
            value:
              simple: Automated remediation by patching vulnerable software
      label: Automated remediation
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: selected
                root: alert.asmdatacollection
          operator: isEqualString
          right:
            value:
              simple: Manual remediation
      label: Manual remediation
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: selected
                root: alert.asmdatacollection
          operator: isEqualString
          right:
            value:
              simple: File a ServiceNow Ticket
      label: ServiceNow ticket
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: selected
                root: alert.asmdatacollection
          operator: isEqualString
          right:
            value:
              simple: Send a notification email
      label: Notification email
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: selected
                root: alert.asmdatacollection
          operator: isEqualString
          right:
            value:
              simple: File a Jira Ticket
      label: Jira ticket
    - condition:
      - - left:
            iscontext: true
            value:
              simple: alert.asmdatacollection.selected
          operator: isEqualString
          right:
            value:
              simple: Send a Slack message
      label: Slack message
    continueonerrortype: ""
    id: "48"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "88"
      Automated remediation:
      - "12"
      Jira ticket:
      - "156"
      Manual remediation:
      - "63"
      Notification email:
      - "60"
      ServiceNow ticket:
      - "10"
      Slack message:
      - "183"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Determines the next action (remediation or ticket) based on the
        previous data collection task.
      id: 21578536-97b4-4a27-842c-4b119942084d
      iscommand: false
      name: What was data collection task response?
      type: condition
      version: -1
    taskid: 21578536-97b4-4a27-842c-4b119942084d
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 70,
          "y": 1315
        }
      }
  "50":
    continueonerrortype: ""
    form:
      description: ""
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: 'Please verify service exposure was resolved by service owner and
            mark "complete" when done:'
        options: []
        optionsarg:
        - simple: Yes, remediation complete
        placeholder: ""
        readonly: false
        required: true
        tooltip: ""
        type: singleSelect
      sender: Your SOC team
      title: Verify that service exposure was resolved by service owner
      totalanswers: 0
    id: "50"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body: null
      cc: null
      format: ""
      methods: []
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      '#none#':
      - "72"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Determines if manual remediation (by service owner or otherwise)
        was completed via analyst input.
      id: 4d07e99c-e580-4bdf-8883-f051bd03c896
      iscommand: false
      name: Verify service exposure resolved by service owner
      type: collection
      version: -1
    taskid: 4d07e99c-e580-4bdf-8883-f051bd03c896
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 690,
          "y": 2400
        }
      }
  "60":
    continueonerrortype: ""
    id: "60"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "176"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: e04643ac-8595-484f-82b5-e5afcd13544f
      iscommand: false
      name: Notification Stage
      type: title
      version: -1
    taskid: e04643ac-8595-484f-82b5-e5afcd13544f
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1080,
          "y": 1600
        }
      }
  "63":
    continueonerrortype: ""
    id: "63"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "88"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 4e9b77ee-dc7b-47da-83a3-3e9c0e6f878f
      iscommand: false
      name: Manual Remediation Stage
      type: title
      version: -1
    taskid: 4e9b77ee-dc7b-47da-83a3-3e9c0e6f878f
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -270,
          "y": 1605
        }
      }
  "69":
    continueonerrortype: ""
    id: "69"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "11"
    note: false
    quietmode: 0
    scriptarguments:
      gridfield:
        simple: asmremediation
      keys:
        simple: action,actiontimestamp,outcome,outcometimestamp
      val1:
        simple: Manual remediation
      val2:
        complex:
          accessor: timestamp
          root: alert.asmdatacollection
      val3:
        simple: Manual remediation completed
      val4:
        simple: TIMESTAMP
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: |-
        Automation used to more easily populate a grid field.  This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well.  Instead of a value you can enter `TIMESTAMP` to get the current timestamp in ISO format.  Example of command:
        `!GridFieldSetup keys=ip,src,timestamp val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" val3="TIMESTAMP" gridfiled="gridfield"`
      id: f2dd6603-f4fa-4499-8958-14daaf688193
      iscommand: false
      name: Set remediation grid field
      script: GridFieldSetup
      type: regular
      version: -1
    taskid: f2dd6603-f4fa-4499-8958-14daaf688193
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 70,
          "y": 2880
        }
      }
  "72":
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                accessor: selected
                root: alert.asmdatacollection
          operator: isEqualString
          right:
            value:
              simple: Manual remediation
      label: manual from data collection
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                root: RemediationAction
          operator: isEqualString
          right:
            value:
              simple: Manual
      label: manual from RPR
    continueonerrortype: ""
    id: "72"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "73"
      manual from RPR:
      - "103"
      manual from data collection:
      - "69"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Determines if "manual remediation" was selected on main data collection
        task.
      id: 78bbbc1a-fe99-4e9a-8435-8960b0af1087
      iscommand: false
      name: Manual remediation selected?
      type: condition
      version: -1
    taskid: 78bbbc1a-fe99-4e9a-8435-8960b0af1087
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 70,
          "y": 2650
        }
      }
  "73":
    continueonerrortype: ""
    id: "73"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "11"
    note: false
    quietmode: 0
    scriptarguments:
      gridfield:
        simple: asmremediation
      keys:
        simple: action,actiontimestamp,outcome,outcometimestamp
      val1:
        complex:
          accessor: type
          root: alert.asmnotification
          transformers:
          - args:
              prefix:
                value:
                  simple: 'Notified service owner via '
              suffix: {}
            operator: concat
      val2:
        complex:
          accessor: timestamp
          root: alert.asmnotification
      val3:
        simple: Resolved by service owner
      val4:
        simple: TIMESTAMP
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: |-
        Automation used to more easily populate a grid field.  This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well.  Instead of a value you can enter `TIMESTAMP` to get the current timestamp in ISO format.  Example of command:
        `!GridFieldSetup keys=ip,src,timestamp val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" val3="TIMESTAMP" gridfiled="gridfield"`
      id: 0b8598c4-c5e0-4cce-8383-c91f58facf2d
      iscommand: false
      name: Set remediation grid field
      script: GridFieldSetup
      type: regular
      version: -1
    taskid: 0b8598c4-c5e0-4cce-8383-c91f58facf2d
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 850,
          "y": 2880
        }
      }
  "81":
    continueonerrortype: ""
    id: "81"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "136"
    note: false
    quietmode: 0
    scriptarguments:
      gridfield:
        simple: asmalertsummary
      keys:
        simple: link,entryid
      val1:
        complex:
          accessor: server
          root: demistoUrls
          transformers:
          - args:
              prefix: {}
              suffix:
                value:
                  simple: /xsoar/entry/download/
            operator: concat
          - args:
              prefix: {}
              suffix:
                iscontext: true
                value:
                  simple: ${lastCompletedTaskEntries.[0]}
            operator: concat
          - args:
              limit: {}
              replaceWith:
                value:
                  simple: '%40'
              toReplace:
                value:
                  simple: '@'
            operator: replace
      val2:
        complex:
          accessor: '[0]'
          root: lastCompletedTaskEntries
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. For example:
        `!GridFieldSetup keys=ip,src val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" gridfiled="gridfield"`
      id: b7f68d25-ba83-4275-8340-e9b0d96fd9e3
      iscommand: false
      name: Set alert summary grid field
      script: GridFieldSetup
      type: regular
      version: -1
    taskid: b7f68d25-ba83-4275-8340-e9b0d96fd9e3
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 70,
          "y": 4140
        }
      }
  "86":
    continueonerrortype: ""
    id: "86"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 0
      wait: 1
    nexttasks:
      '#none#':
      - "20"
    note: false
    quietmode: 0
    scriptarguments:
      ASMRuleID:
        complex:
          accessor: asmattacksurfaceruleid
          root: alert
      RemoteIP:
        complex:
          accessor: remoteip
          root: alert
      RemotePort:
        complex:
          accessor: remoteport
          root: alert
      ScanNumber:
        simple: "2"
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      description: Playbook that looks at what ASM sub-type the alert is and directs
        it to different pre/post mitigation scans (such as NMAP).
      id: 7760cd6c-8132-4e21-8eb5-9769a3834bc9
      iscommand: false
      name: Cortex ASM - Detect Service
      playbookId: Cortex ASM - Detect Service
      type: playbook
      version: -1
    taskid: 7760cd6c-8132-4e21-8eb5-9769a3834bc9
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 70,
          "y": 3190
        }
      }
  "88":
    continueonerrortype: ""
    form:
      description: ""
      expired: false
      questions:
      - defaultrows: []
        fieldassociated: ""
        gridcolumns: []
        id: "0"
        label: ""
        labelarg:
          simple: 'Please complete manual remediation and mark "complete" when done:'
        options: []
        optionsarg:
        - simple: Yes, remediation complete
        placeholder: ""
        readonly: false
        required: true
        tooltip: ""
        type: singleSelect
      sender: Your SOC team
      title: Verify that manual remediation was completed
      totalanswers: 0
    id: "88"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    message:
      bcc: null
      body: null
      cc: null
      format: ""
      methods: []
      subject: null
      timings:
        completeafterreplies: 1
        completeaftersla: false
        completeafterv2: true
        retriescount: 2
        retriesinterval: 360
      to: null
    nexttasks:
      '#none#':
      - "133"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Determines if manual remediation (by service owner or otherwise)
        was completed via analyst input.
      id: f3b899dd-18a9-48f6-8503-7cf6263aca64
      iscommand: false
      name: Complete manual remediation
      type: collection
      version: -1
    taskid: f3b899dd-18a9-48f6-8503-7cf6263aca64
    timertriggers: []
    type: collection
    view: |-
      {
        "position": {
          "x": 70,
          "y": 2230
        }
      }
  "103":
    continueonerrortype: ""
    id: "103"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "11"
    note: false
    quietmode: 0
    scriptarguments:
      gridfield:
        simple: asmremediation
      keys:
        simple: action,actiontimestamp,outcome,outcometimestamp
      val1:
        simple: Manual remediation
      val2:
        complex:
          root: RPR_Timestamp
      val3:
        simple: Manual remediation completed
      val4:
        simple: TIMESTAMP
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. Instead of a value, you can enter `TIMESTAMP` to get the current timestamp in ISO format.  Example of the command:
        `!GridFieldSetup keys=ip,src,timestamp val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" val3="TIMESTAMP" gridfiled="gridfield"`
      id: 4ac1a981-fe3b-4cad-807b-3b40afbba041
      iscommand: false
      name: Set remediation grid field
      script: GridFieldSetup
      type: regular
      version: -1
    taskid: 4ac1a981-fe3b-4cad-807b-3b40afbba041
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 460,
          "y": 2880
        }
      }
  "110":
    conditions:
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                accessor: outcome
                root: alert.asmremediation
          operator: isEqualString
          right:
            value:
              simple: Success
      - - left:
            iscontext: true
            value:
              complex:
                accessor: asmremediationpathrule
                root: alert
          operator: isNotEmpty
      label: Automated-Remediation With Rule Match
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                accessor: outcome
                root: alert.asmremediation
          operator: isEqualString
          right:
            value:
              simple: Success
      label: ' Automated-Remediation'
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                accessor: "0"
                root: Select a next step.Answers
          operator: isEqualString
          right:
            value:
              simple: Close Now
      - - left:
            iscontext: true
            value:
              complex:
                accessor: asmremediationpathrule
                root: alert
          operator: isNotEmpty
      label: Close Now With Rule Match
    - condition:
      - - ignorecase: true
          left:
            iscontext: true
            value:
              complex:
                accessor: "0"
                root: Select a next step.Answers
          operator: isEqualString
          right:
            value:
              simple: Close Now
      label: Close Now
    continueonerrortype: ""
    id: "110"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      ' Automated-Remediation':
      - "112"
      '#default#':
      - "4"
      Automated-Remediation With Rule Match:
      - "114"
      Close Now:
      - "111"
      Close Now With Rule Match:
      - "113"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Determines if the alert will be closed or kept open.
      id: 9384d7c9-9814-45cb-863d-6cecba635833
      iscommand: false
      name: Close or keep open?
      type: condition
      version: -1
    taskid: 9384d7c9-9814-45cb-863d-6cecba635833
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 70,
          "y": 4470
        }
      }
  "111":
    continueonerrortype: ""
    id: "111"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "4"
    note: false
    quietmode: 0
    scriptarguments:
      closeNotes:
        simple: Alert status set to 'Resolved' by Active Response Module
      closeReason:
        simple: Resolved
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: Close the current alert because auto-close was selected.
      id: 9243de06-b239-4956-80c8-b0c36a28ce99
      iscommand: true
      name: Close alert (close now)
      script: Builtin|||closeInvestigation
      type: regular
      version: -1
    taskid: 9243de06-b239-4956-80c8-b0c36a28ce99
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -150,
          "y": 4790
        }
      }
  "112":
    continueonerrortype: ""
    id: "112"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "4"
    note: false
    quietmode: 0
    scriptarguments:
      closeNotes:
        simple: Alert status set to 'Resolved - Remediated Automatically' by Active
          Response Module
      closeReason:
        simple: Resolved - Remediated Automatically
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: Close the current alert because Automated Remediation path was
        selected.
      id: eac13f7d-5da0-4dfa-8b41-568ab413edec
      iscommand: true
      name: Close alert (remediated automatically)
      script: Builtin|||closeInvestigation
      type: regular
      version: -1
    taskid: eac13f7d-5da0-4dfa-8b41-568ab413edec
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 290,
          "y": 4790
        }
      }
  "113":
    continueonerrortype: ""
    id: "113"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "4"
    note: false
    quietmode: 0
    scriptarguments:
      closeNotes:
        complex:
          accessor: rule_name
          root: alert.asmremediationpathrule
          transformers:
          - args:
              prefix:
                value:
                  simple: 'Alert status set to ''Resolved'' by Active Response Module
                    - Remediation Path Rule: '
              suffix: {}
            operator: concat
      closeReason:
        simple: Resolved
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: Close the current alert because auto-close was selected.
      id: b94080d0-cf5d-408b-8a5f-d1a3e781f33b
      iscommand: true
      name: Close alert (close now) with rule match
      script: Builtin|||closeInvestigation
      type: regular
      version: -1
    taskid: b94080d0-cf5d-408b-8a5f-d1a3e781f33b
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -470,
          "y": 4650
        }
      }
  "114":
    continueonerrortype: ""
    id: "114"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "4"
    note: false
    quietmode: 0
    scriptarguments:
      closeNotes:
        complex:
          accessor: rule_name
          root: alert.asmremediationpathrule
          transformers:
          - args:
              prefix:
                value:
                  simple: 'Alert status set to ''Resolved - Remediated Automatically''
                    by Active Response Module - Remediation Path Rule: '
              suffix: {}
            operator: concat
      closeReason:
        simple: Resolved - Remediated Automatically
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: Close the current alert because Automated Remediation path was
        selected.
      id: 9cce412b-6cb5-403e-8ba5-1092762c0fb6
      iscommand: true
      name: Close alert (remediated automatically) with rule match
      script: Builtin|||closeInvestigation
      type: regular
      version: -1
    taskid: 9cce412b-6cb5-403e-8ba5-1092762c0fb6
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 660,
          "y": 4660
        }
      }
  "121":
    continueonerrortype: ""
    id: "121"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "175"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 598c7420-4eeb-48fc-8b5f-b539d6085c05
      iscommand: false
      name: Analysis Stage
      type: title
      version: -1
    taskid: 598c7420-4eeb-48fc-8b5f-b539d6085c05
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 70,
          "y": -535
        }
      }
  "124":
    continueonerrortype: ""
    id: "124"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "6"
    note: false
    quietmode: 0
    scriptarguments:
      gridfield:
        simple: asmplaybookstage
      keys:
        simple: stage,timestamp
      val1:
        simple: triage
      val2:
        simple: TIMESTAMP
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. Instead of a value, you can enter `TIMESTAMP` to get the current timestamp in ISO format.  Example of the command:
        `!GridFieldSetup keys=ip,src,timestamp val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" val3="TIMESTAMP" gridfiled="gridfield"`
      id: 83cd02a3-ed01-4a17-8376-a2b8c394944c
      iscommand: false
      name: Set playbook stage grid field (triage)
      script: GridFieldSetup
      type: regular
      version: -1
    taskid: 83cd02a3-ed01-4a17-8376-a2b8c394944c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 70,
          "y": -1170
        }
      }
  "125":
    continueonerrortype: ""
    id: "125"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "121"
    note: false
    quietmode: 0
    scriptarguments:
      gridfield:
        simple: asmplaybookstage
      keys:
        simple: stage,timestamp
      val1:
        simple: enrichment
      val2:
        simple: TIMESTAMP
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. Instead of a value, you can enter `TIMESTAMP` to get the current timestamp in ISO format.  Example of the command:
        `!GridFieldSetup keys=ip,src,timestamp val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" val3="TIMESTAMP" gridfiled="gridfield"`
      id: 422e3206-c215-49c0-8c50-0225df53a429
      iscommand: false
      name: Set playbook stage grid field (enrichment)
      script: GridFieldSetup
      type: regular
      version: -1
    taskid: 422e3206-c215-49c0-8c50-0225df53a429
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 70,
          "y": -705
        }
      }
  "126":
    continueonerrortype: ""
    id: "126"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "144"
    note: false
    quietmode: 0
    scriptarguments:
      gridfield:
        simple: asmplaybookstage
      keys:
        simple: stage,timestamp
      val1:
        simple: analysis
      val2:
        simple: TIMESTAMP
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. Instead of a value, you can enter `TIMESTAMP` to get the current timestamp in ISO format.  Example of the command:
        `!GridFieldSetup keys=ip,src,timestamp val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" val3="TIMESTAMP" gridfiled="gridfield"`
      id: 4d3f708f-412f-409d-815c-d8daf22f1000
      iscommand: false
      name: Set playbook stage grid field (analysis)
      script: GridFieldSetup
      type: regular
      version: -1
    taskid: 4d3f708f-412f-409d-815c-d8daf22f1000
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 70,
          "y": -40
        }
      }
  "128":
    continueonerrortype: ""
    id: "128"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "63"
    note: false
    quietmode: 0
    scriptarguments:
      gridfield:
        simple: asmplaybookstage
      keys:
        simple: stage,timestamp
      val1:
        simple: decision
      val2:
        simple: TIMESTAMP
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. Instead of a value, you can enter `TIMESTAMP` to get the current timestamp in ISO format.  Example of the command:
        `!GridFieldSetup keys=ip,src,timestamp val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" val3="TIMESTAMP" gridfiled="gridfield"`
      id: 028eece5-24f0-4890-89f8-3803d33144e0
      iscommand: false
      name: Set playbook stage grid field (decision)
      script: GridFieldSetup
      type: regular
      version: -1
    taskid: 028eece5-24f0-4890-89f8-3803d33144e0
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -270,
          "y": 1180
        }
      }
  "129":
    continueonerrortype: ""
    id: "129"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "12"
    note: false
    quietmode: 0
    scriptarguments:
      gridfield:
        simple: asmplaybookstage
      keys:
        simple: stage,timestamp
      val1:
        simple: decision
      val2:
        simple: TIMESTAMP
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. Instead of a value, you can enter `TIMESTAMP` to get the current timestamp in ISO format.  Example of the command:
        `!GridFieldSetup keys=ip,src,timestamp val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" val3="TIMESTAMP" gridfiled="gridfield"`
      id: d814ba48-42c5-414d-86c9-dfeb842f02f0
      iscommand: false
      name: Set playbook stage grid field (decision)
      script: GridFieldSetup
      type: regular
      version: -1
    taskid: d814ba48-42c5-414d-86c9-dfeb842f02f0
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -700,
          "y": 1125
        }
      }
  "130":
    continueonerrortype: ""
    id: "130"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "10"
    note: false
    quietmode: 0
    scriptarguments:
      gridfield:
        simple: asmplaybookstage
      keys:
        simple: stage,timestamp
      val1:
        simple: decision
      val2:
        simple: TIMESTAMP
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. Instead of a value, you can enter `TIMESTAMP` to get the current timestamp in ISO format.  Example of the command:
        `!GridFieldSetup keys=ip,src,timestamp val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" val3="TIMESTAMP" gridfiled="gridfield"`
      id: b48cba1e-0a6c-4a12-8bf7-9f2bbf47b37a
      iscommand: false
      name: Set playbook stage grid field (decision)
      script: GridFieldSetup
      type: regular
      version: -1
    taskid: b48cba1e-0a6c-4a12-8bf7-9f2bbf47b37a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 690,
          "y": 1145
        }
      }
  "131":
    continueonerrortype: ""
    id: "131"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "60"
    note: false
    quietmode: 0
    scriptarguments:
      gridfield:
        simple: asmplaybookstage
      keys:
        simple: stage,timestamp
      val1:
        simple: decision
      val2:
        simple: TIMESTAMP
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. Instead of a value, you can enter `TIMESTAMP` to get the current timestamp in ISO format.  Example of the command:
        `!GridFieldSetup keys=ip,src,timestamp val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" val3="TIMESTAMP" gridfiled="gridfield"`
      id: 768ae5de-aa06-4975-8e4c-aa9ae75ece4b
      iscommand: false
      name: Set playbook stage grid field (decision)
      script: GridFieldSetup
      type: regular
      version: -1
    taskid: 768ae5de-aa06-4975-8e4c-aa9ae75ece4b
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1080,
          "y": 1125
        }
      }
  "133":
    continueonerrortype: ""
    id: "133"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "72"
    note: false
    quietmode: 0
    scriptarguments:
      gridfield:
        simple: asmplaybookstage
      keys:
        simple: stage,timestamp
      val1:
        simple: remediation
      val2:
        simple: TIMESTAMP
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. Instead of a value, you can enter `TIMESTAMP` to get the current timestamp in ISO format.  Example of the command:
        `!GridFieldSetup keys=ip,src,timestamp val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" val3="TIMESTAMP" gridfiled="gridfield"`
      id: cd2d1025-4773-4743-8baf-dec1932028bd
      iscommand: false
      name: Set playbook stage grid field (remediation)
      script: GridFieldSetup
      type: regular
      version: -1
    taskid: cd2d1025-4773-4743-8baf-dec1932028bd
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 70,
          "y": 2400
        }
      }
  "134":
    continueonerrortype: ""
    id: "134"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "50"
    note: false
    quietmode: 0
    scriptarguments:
      gridfield:
        simple: asmplaybookstage
      keys:
        simple: stage,timestamp
      val1:
        simple: notification
      val2:
        simple: TIMESTAMP
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Automation used to more easily populate a grid field.  This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well.  Instead of a value you can enter `TIMESTAMP` to get the current timestamp in ISO format.  Example of command:
        `!GridFieldSetup keys=ip,src,timestamp val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" val3="TIMESTAMP" gridfiled="gridfield"`
      id: 238955d2-13ea-4e94-816f-d28db1defaf2
      iscommand: false
      name: Set playbook stage grid field (notification)
      script: GridFieldSetup
      type: regular
      version: -1
    taskid: 238955d2-13ea-4e94-816f-d28db1defaf2
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 690,
          "y": 2005
        }
      }
  "135":
    continueonerrortype: ""
    id: "135"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "13"
    note: false
    quietmode: 0
    scriptarguments:
      gridfield:
        simple: asmplaybookstage
      keys:
        simple: stage,timestamp
      val1:
        simple: validation
      val2:
        simple: TIMESTAMP
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Automation used to more easily populate a grid field.  This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well.  Instead of a value you can enter `TIMESTAMP` to get the current timestamp in ISO format.  Example of command:
        `!GridFieldSetup keys=ip,src,timestamp val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" val3="TIMESTAMP" gridfiled="gridfield"`
      id: e33d4d1a-08ec-4517-8930-445a3b108f08
      iscommand: false
      name: Set playbook stage grid field (validation)
      script: GridFieldSetup
      type: regular
      version: -1
    taskid: e33d4d1a-08ec-4517-8930-445a3b108f08
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 70,
          "y": 3700
        }
      }
  "136":
    continueonerrortype: ""
    id: "136"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "110"
    note: false
    quietmode: 0
    scriptarguments:
      gridfield:
        simple: asmplaybookstage
      keys:
        simple: stage,timestamp
      val1:
        simple: summarization
      val2:
        simple: TIMESTAMP
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Automation used to more easily populate a grid field.  This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well.  Instead of a value you can enter `TIMESTAMP` to get the current timestamp in ISO format.  Example of command:
        `!GridFieldSetup keys=ip,src,timestamp val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" val3="TIMESTAMP" gridfiled="gridfield"`
      id: 8c17fd19-2790-46fa-878d-ad53d3fff9f8
      iscommand: false
      name: Set playbook stage grid field (summarization)
      script: GridFieldSetup
      type: regular
      version: -1
    taskid: 8c17fd19-2790-46fa-878d-ad53d3fff9f8
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 70,
          "y": 4310
        }
      }
  "141":
    continueonerrortype: ""
    id: "141"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "142"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 6152a9df-a84b-4bbe-8a9f-59afec75c4ae
      iscommand: false
      name: continue
      type: title
      version: -1
    taskid: 6152a9df-a84b-4bbe-8a9f-59afec75c4ae
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -1110,
          "y": 995
        }
      }
  "142":
    continueonerrortype: ""
    id: "142"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "4"
    note: false
    quietmode: 0
    scriptarguments:
      closeNotes:
        simple: Alert status set to 'Resolved - Risk Accepted' by Active Response
          Module
      closeReason:
        simple: Resolved - Risk Accepted
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: Close the current alert because the service is no longer observed.
      id: 0e38bd21-c3da-422c-8ac8-a2ebcaf93a39
      iscommand: true
      name: Close alert (accepted risk)
      script: Builtin|||closeInvestigation
      type: regular
      version: -1
    taskid: 0e38bd21-c3da-422c-8ac8-a2ebcaf93a39
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -920,
          "y": 4650
        }
      }
  "144":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: id
                filters:
                - - left:
                      iscontext: true
                      value:
                        simple: alert.asmsystemids.type
                    operator: isEqualString
                    right:
                      value:
                        simple: ASSET-ID
                root: alert.asmsystemids
          operator: inList
          right:
            iscontext: true
            value:
              complex:
                root: inputs.AcceptedRiskIDs
        - left:
            iscontext: true
            value:
              complex:
                accessor: id
                filters:
                - - left:
                      iscontext: true
                      value:
                        simple: alert.asmsystemids.type
                    operator: isEqualString
                    right:
                      value:
                        simple: GCP-Project-Number
                root: alert.asmsystemids
          operator: inList
          right:
            iscontext: true
            value:
              complex:
                root: inputs.AcceptedRiskProjects
        - left:
            iscontext: true
            value:
              complex:
                accessor: project
                filters:
                - - left:
                      iscontext: true
                      value:
                        simple: alert.asmcloud.provider
                    operator: isEqualString
                    right:
                      value:
                        simple: AWS
                root: alert.asmcloud
          operator: inList
          right:
            iscontext: true
            value:
              complex:
                root: inputs.AcceptedRiskProjects
        - left:
            iscontext: true
            value:
              complex:
                accessor: id
                filters:
                - - left:
                      iscontext: true
                      value:
                        simple: alert.asmsystemids.type
                    operator: isEqualString
                    right:
                      value:
                        simple: GCP-Folder-Number
                root: alert.asmsystemids
          operator: inList
          right:
            iscontext: true
            value:
              complex:
                root: inputs.AcceptedRiskOther
        - left:
            iscontext: true
            value:
              complex:
                accessor: organization
                filters:
                - - left:
                      iscontext: true
                      value:
                        simple: alert.asmcloud.provider
                    operator: isEqualString
                    right:
                      value:
                        simple: Azure
                root: alert.asmcloud
          operator: inList
          right:
            iscontext: true
            value:
              complex:
                root: inputs.AcceptedRiskOther
        - left:
            iscontext: true
            value:
              complex:
                accessor: id
                filters:
                - - left:
                      iscontext: true
                      value:
                        simple: alert.asmsystemids.type
                    operator: isEqualString
                    right:
                      value:
                        simple: ASSET-RG
                root: alert.asmsystemids
          operator: inList
          right:
            iscontext: true
            value:
              complex:
                root: inputs.AcceptedRiskProjects
      label: "yes"
    continueonerrortype: ""
    id: "144"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "8"
      "yes":
      - "141"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Checks if the system IDs, folders, and projects are present in
        the accepted risk lists.
      id: 167fe7ef-89a1-413f-85cb-94d9c086d6d1
      iscommand: false
      name: Are there any matches from accepted risk lists?
      type: condition
      version: -1
    taskid: 167fe7ef-89a1-413f-85cb-94d9c086d6d1
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 70,
          "y": 120
        }
      }
  "145":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: RemediationAction
          operator: isEqualString
          right:
            value:
              simple: AR
      label: Automated Remediation
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: RemediationAction
          operator: isEqualString
          right:
            value:
              simple: SNOW
      label: ServiceNow Ticket
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: RemediationAction
          operator: isEqualString
          right:
            value:
              simple: Email
      label: Notification Email
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: RemediationAction
          operator: isEqualString
          right:
            value:
              simple: Manual
      label: Manual Remediation
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: RemediationAction
          operator: isEqualString
          right:
            value:
              simple: Jira
      label: Jira Ticket
    - condition:
      - - left:
            iscontext: true
            value:
              simple: RemediationAction
          operator: isEqualString
          right:
            value:
              simple: Slack
      label: Slack
    continueonerrortype: ""
    id: "145"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "48"
      Automated Remediation:
      - "146"
      Jira Ticket:
      - "161"
      Manual Remediation:
      - "152"
      Notification Email:
      - "163"
      ServiceNow Ticket:
      - "162"
      Slack:
      - "181"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Determines what the remediation action is (direct action or data
        collection task).
      id: 87cca956-c103-4e7c-84a4-0bfa10d39b81
      iscommand: false
      name: What is the remediation action?
      type: condition
      version: -1
    taskid: 87cca956-c103-4e7c-84a4-0bfa10d39b81
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 70,
          "y": 660
        }
      }
  "146":
    continueonerrortype: ""
    id: "146"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "129"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 5cc9450d-b22b-4100-8390-f3ec343b9319
      iscommand: false
      name: Automated Remediation
      type: title
      version: -1
    taskid: 5cc9450d-b22b-4100-8390-f3ec343b9319
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -700,
          "y": 995
        }
      }
  "152":
    continueonerrortype: ""
    id: "152"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "128"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 3ca6aa20-4977-4c33-8d6f-4506f9f5af07
      iscommand: false
      name: Manual Remediation
      type: title
      version: -1
    taskid: 3ca6aa20-4977-4c33-8d6f-4506f9f5af07
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -270,
          "y": 1050
        }
      }
  "156":
    continueonerrortype: ""
    id: "156"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "178"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 79daba2b-1791-4d5c-855c-fb9d663191ee
      iscommand: false
      name: Notification Stage
      type: title
      version: -1
    taskid: 79daba2b-1791-4d5c-855c-fb9d663191ee
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 290,
          "y": 1630
        }
      }
  "157":
    continueonerrortype: ""
    id: "157"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "156"
    note: false
    quietmode: 0
    scriptarguments:
      gridfield:
        simple: asmplaybookstage
      keys:
        simple: stage,timestamp
      val1:
        simple: decision
      val2:
        simple: TIMESTAMP
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. Instead of a value, you can enter `TIMESTAMP` to get the current timestamp in ISO format.  Example of the command:
        `!GridFieldSetup keys=ip,src,timestamp val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" val3="TIMESTAMP" gridfiled="gridfield"`
      id: 9c6555fc-9a4f-480d-8292-0aa18468581c
      iscommand: false
      name: Set playbook stage grid field (decision)
      script: GridFieldSetup
      type: regular
      version: -1
    taskid: 9c6555fc-9a4f-480d-8292-0aa18468581c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 290,
          "y": 1175
        }
      }
  "161":
    continueonerrortype: ""
    id: "161"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "157"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 5617a3f5-278a-492e-8d16-09e896120c1d
      iscommand: false
      name: Jira Ticket
      type: title
      version: -1
    taskid: 5617a3f5-278a-492e-8d16-09e896120c1d
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 290,
          "y": 1040
        }
      }
  "162":
    continueonerrortype: ""
    id: "162"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "130"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 0d78ff20-65b6-48a7-8f3e-c0d99809a5bf
      iscommand: false
      name: ServiceNow Ticket
      type: title
      version: -1
    taskid: 0d78ff20-65b6-48a7-8f3e-c0d99809a5bf
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 690,
          "y": 1010
        }
      }
  "163":
    continueonerrortype: ""
    id: "163"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "131"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 68147b67-a457-4d09-817b-bbf1a7539f20
      iscommand: false
      name: Email Notification
      type: title
      version: -1
    taskid: 68147b67-a457-4d09-817b-bbf1a7539f20
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1080,
          "y": 990
        }
      }
  "164":
    continueonerrortype: ""
    id: "164"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "168"
    note: false
    quietmode: 0
    scriptarguments:
      gridfield:
        simple: asmremediation
      keys:
        simple: action,actiontimestamp,outcome,outcometimestamp
      val1:
        simple: close service port from internet
      val2:
        simple: TIMESTAMP
      val3:
        simple: Success
      val4:
        simple: TIMESTAMP
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: |-
        Automation used to more easily populate a grid field.  This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well.  Instead of a value you can enter `TIMESTAMP` to get the current timestamp in ISO format.  Example of the command:
        `!GridFieldSetup keys=ip,src,timestamp val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" val3="TIMESTAMP" gridfiled="gridfield"`
      id: cf574345-4885-46c3-8781-6fe82703cd32
      iscommand: false
      name: Set remediation grid field
      script: GridFieldSetup
      type: regular
      version: -1
    taskid: cf574345-4885-46c3-8781-6fe82703cd32
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -690,
          "y": 1860
        }
      }
  "165":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: email
                filters:
                - - left:
                      iscontext: true
                      value:
                        simple: alert.asmserviceowner.email
                    operator: containsGeneral
                    right:
                      value:
                        simple: '@'
                root: alert.asmserviceowner
          operator: isNotEmpty
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "165"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "11"
      "yes":
      - "166"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Verifies if we have emails for service owners.
      id: 3b65d35e-d409-446e-8200-8c7a2d26b927
      iscommand: false
      name: Are there service owners with emails?
      type: condition
      version: -1
    taskid: 3b65d35e-d409-446e-8200-8c7a2d26b927
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -690,
          "y": 2210
        }
      }
  "166":
    continueonerrortype: ""
    id: "166"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "169"
    note: false
    quietmode: 0
    scriptarguments:
      htmlBody:
        complex:
          root: inputs.RemediationNotificationHTMLBody
      subject:
        complex:
          root: inputs.RemediationNotificationSubject
      to:
        complex:
          accessor: email
          filters:
          - - left:
                iscontext: true
                value:
                  simple: alert.asmserviceowner.email
              operator: containsGeneral
              right:
                value:
                  simple: '@'
          root: alert.asmserviceowner
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Send an email to service owners regarding the status of the automated
        remediation action that was taken.
      id: ddad11be-1a2e-45a3-8030-1696ba3fe875
      iscommand: true
      name: Send remediation notification email to service owners
      script: '|||send-mail'
      type: regular
      version: -1
    taskid: ddad11be-1a2e-45a3-8030-1696ba3fe875
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -810,
          "y": 2440
        }
      }
  "168":
    continueonerrortype: ""
    id: "168"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "165"
    note: false
    quietmode: 0
    scriptarguments:
      gridfield:
        simple: asmplaybookstage
      keys:
        simple: stage,timestamp
      val1:
        simple: remediation
      val2:
        simple: TIMESTAMP
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. Instead of a value, you can enter `TIMESTAMP` to get the current timestamp in ISO format.  Example of the command:
        `!GridFieldSetup keys=ip,src,timestamp val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" val3="TIMESTAMP" gridfiled="gridfield"`
      id: 3f1c6f44-04d4-4590-838c-d88bc36fbd79
      iscommand: false
      name: Set playbook stage grid field (remediation)
      script: GridFieldSetup
      type: regular
      version: -1
    taskid: 3f1c6f44-04d4-4590-838c-d88bc36fbd79
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -690,
          "y": 2040
        }
      }
  "169":
    continueonerrortype: ""
    id: "169"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "11"
    note: false
    quietmode: 0
    scriptarguments:
      gridfield:
        simple: asmplaybookstage
      keys:
        simple: stage,timestamp
      val1:
        simple: notification
      val2:
        simple: TIMESTAMP
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Automation used to more easily populate a grid field.  This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well.  Instead of a value you can enter `TIMESTAMP` to get the current timestamp in ISO format.  Example of the command:
        `!GridFieldSetup keys=ip,src,timestamp val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" val3="TIMESTAMP" gridfiled="gridfield"`
      id: ef95362b-ca5f-483b-8f1c-b49eaa591bb5
      iscommand: false
      name: Set playbook stage grid field (notification)
      script: GridFieldSetup
      type: regular
      version: -1
    taskid: ef95362b-ca5f-483b-8f1c-b49eaa591bb5
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -810,
          "y": 2600
        }
      }
  "171":
    continueonerrortype: ""
    id: "171"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "124"
    note: false
    quietmode: 0
    scriptarguments:
      asmalertsummary:
        simple: '[]'
      asmcloud:
        simple: '[]'
      asmdatacollection:
        simple: '[]'
      asmdevcheckdetails:
        simple: '[]'
      asmenrichmentstatus:
        simple: '[]'
      asmnotification:
        simple: '[]'
      asmplaybookstage:
        simple: '[]'
      asmprivateip:
        simple: '[]'
      asmremediation:
        simple: '[]'
      asmremediationobjectives:
        simple: '[{"option": "File a ServiceNow Ticket", "statement": "In this case,
          a ServiceNow ticket will be created with some information on the alert and
          possible remediation guidance suggestions."},{"option": "File a Jira Ticket",
          "statement": "In this case, a Jira ticket will be created with some information
          on the alert and possible remediation guidance suggestions."},{"option":
          "Send a notification email", "statement": "In this case, an email ticket
          will be created with some information on the alert and possible remediation
          guidance suggestions."},{"option": "Manual remediation", "statement": "In
          this case, we will require you to manually remediate this exposure."}]'
      asmremediationpathrule:
        simple: '[]'
      asmservicedetection:
        simple: '[]'
      asmserviceowner:
        simple: '[]'
      asmserviceownerunrankedraw:
        simple: '[]'
      asmsystemids:
        simple: '[]'
      asmtags:
        simple: '[]'
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: Clear ASM grid fields in case the playbook is rerun.
      id: 1b619bad-e5c8-41f8-85f8-54c7ad48c8bc
      iscommand: true
      name: Initialize grid fields
      script: Builtin|||setAlert
      type: regular
      version: -1
    taskid: 1b619bad-e5c8-41f8-85f8-54c7ad48c8bc
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 70,
          "y": -1340
        }
      }
  "172":
    continueonerrortype: ""
    id: "172"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "126"
    note: false
    quietmode: 0
    scriptarguments:
      alert_details:
        complex:
          accessor: details
          root: alert
      alert_id:
        complex:
          accessor: id
          root: alert
      alert_name:
        complex:
          accessor: name
          root: alert
      alert_severityStr:
        complex:
          accessor: severityStr
          root: alert
      asm_asset_id:
        complex:
          accessor: asmassetid
          root: alert
      asm_cloud:
        complex:
          accessor: asmcloud
          root: alert
      asm_data_collection:
        complex:
          accessor: asmdatacollection
          root: alert
      asm_notification:
        complex:
          accessor: asmnotification
          root: alert
      asm_private_ip:
        complex:
          accessor: asmprivateip
          root: alert
      asm_related:
        complex:
          accessor: asmrelated
          root: alert
      asm_remediation:
        complex:
          accessor: asmremediation
          root: alert
      asm_remediation_guidance:
        complex:
          root: RemediationGuidance
      asm_remediation_path_rule:
        complex:
          accessor: asmremediationpathrule
          root: alert
      asm_service_detection:
        complex:
          accessor: asmservicedetection
          root: alert
      asm_service_id:
        complex:
          accessor: asmserviceid
          root: alert
      asm_service_owner:
        complex:
          accessor: asmserviceowner
          root: alert
      asm_system_ids:
        complex:
          accessor: asmsystemids
          root: alert
      asm_tags:
        complex:
          accessor: asmtags
          root: alert
      report_type:
        simple: analysis
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Generate an ASM Alert Summary report.
      id: 24dedd51-5427-4637-8cfc-b5dc476678a7
      iscommand: false
      name: GenerateSummaryReport - Analysis
      script: GenerateASMReport
      type: regular
      version: -1
    taskid: 24dedd51-5427-4637-8cfc-b5dc476678a7
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 70,
          "y": -220
        }
      }
  "175":
    continueonerrortype: ""
    id: "175"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "172"
    note: false
    quietmode: 0
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      id: 27b52a79-73b2-46f1-8df7-8f139873b8f4
      iscommand: false
      name: Cortex ASM - Remediation Guidance
      playbookId: Cortex ASM - Remediation Guidance
      type: playbook
      version: -1
    taskid: 27b52a79-73b2-46f1-8df7-8f139873b8f4
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 70,
          "y": -380
        }
      }
  "176":
    continueonerrortype: ""
    id: "176"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "134"
    note: false
    quietmode: 0
    scriptarguments:
      OwnerNotificationBody:
        complex:
          root: inputs.OwnerNotificationBody
      OwnerNotificationSubject:
        complex:
          root: inputs.OwnerNotificationSubject
      RemediationGuidance:
        complex:
          root: RemediationGuidance
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      description: This playbook is used to send email notifications to service owners
        to notify them of their internet exposures.
      id: e7101013-512c-48bf-8a4c-6a70b08dec6d
      iscommand: false
      name: Cortex ASM - Email Notification
      playbookId: Cortex ASM - Email Notification
      type: playbook
      version: -1
    taskid: e7101013-512c-48bf-8a4c-6a70b08dec6d
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 1080,
          "y": 1795
        }
      }
  "177":
    continueonerrortype: ""
    id: "177"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "81"
    note: false
    quietmode: 0
    scriptarguments:
      alert_details:
        complex:
          accessor: details
          root: alert
      alert_id:
        complex:
          accessor: id
          root: alert
      alert_name:
        complex:
          accessor: name
          root: alert
      alert_severityStr:
        complex:
          accessor: severityStr
          root: alert
      asm_asset_id:
        complex:
          accessor: asmassetid
          root: alert
      asm_cloud:
        complex:
          accessor: asmcloud
          root: alert
      asm_data_collection:
        complex:
          accessor: asmdatacollection
          root: alert
      asm_notification:
        complex:
          accessor: asmnotification
          root: alert
      asm_private_ip:
        complex:
          accessor: asmprivateip
          root: alert
      asm_related:
        complex:
          accessor: asmrelated
          root: alert
      asm_remediation:
        complex:
          accessor: asmremediation
          root: alert
      asm_remediation_guidance:
        complex:
          root: RemediationGuidance
      asm_remediation_path_rule:
        complex:
          accessor: asmremediationpathrule
          root: alert
      asm_service_detection:
        complex:
          accessor: asmservicedetection
          root: alert
      asm_service_id:
        complex:
          accessor: asmserviceid
          root: alert
      asm_service_owner:
        complex:
          accessor: asmserviceowner
          root: alert
      asm_system_ids:
        complex:
          accessor: asmsystemids
          root: alert
      asm_tags:
        complex:
          accessor: asmtags
          root: alert
      report_type:
        simple: summary
      retry-count:
        simple: "1"
      retry-interval:
        simple: "30"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Generate an ASM Alert Summary report.
      id: ac48f670-dfa1-4419-8bd3-a0bdc2b54c40
      iscommand: false
      name: GenerateSummaryReport - Summary
      script: GenerateASMReport
      type: regular
      version: -1
    taskid: ac48f670-dfa1-4419-8bd3-a0bdc2b54c40
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 70,
          "y": 3980
        }
      }
  "178":
    continueonerrortype: ""
    id: "178"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "134"
    note: false
    quietmode: 0
    scriptarguments:
      JiraProjectKey:
        complex:
          root: inputs.JiraProjectKey
      OwnerNotificationBody:
        complex:
          root: inputs.OwnerNotificationBody
      RemediationGuidance:
        complex:
          root: RemediationGuidance
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      id: 31a1fbd0-1f8f-462a-81fd-79b5f5c2d462
      iscommand: false
      name: Cortex ASM - Jira Notification
      playbookId: Cortex ASM - Jira Notification
      type: playbook
      version: -1
    taskid: 31a1fbd0-1f8f-462a-81fd-79b5f5c2d462
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 290,
          "y": 1830
        }
      }
  "179":
    continueonerrortype: ""
    id: "179"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "134"
    note: false
    quietmode: 0
    scriptarguments:
      NotificationTicketType:
        complex:
          root: inputs.NotificationTicketType
      OwnerNotificationBody:
        complex:
          root: inputs.OwnerNotificationBody
      RemediationGuidance:
        complex:
          root: RemediationGuidance
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      id: 70be4075-98e6-4a30-85bd-2a2fd6c3bbbd
      iscommand: false
      name: Cortex ASM - ServiceNow Notification
      playbookId: Cortex ASM - ServiceNow Notification
      type: playbook
      version: -1
    taskid: 70be4075-98e6-4a30-85bd-2a2fd6c3bbbd
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 690,
          "y": 1815
        }
      }
  "180":
    continueonerrortype: ""
    id: "180"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "171"
    note: false
    quietmode: 0
    scriptarguments:
      all:
        simple: "yes"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: "Delete field from context.\n\nThis automation runs using the default
        Limited User role, unless you explicitly change the permissions.\nFor more
        information, see the section about permissions here:\n- For Cortex see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.x/Cortex-XSOAR-Playbook-Design-Guide/Automations
        \n- For Cortex Cloud see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8/Cortex-XSOAR-Cloud-Documentation/Create-a-script\n-
        For Cortex.7 On-prem see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8.7/Cortex-XSOAR-On-prem-Documentation/Create-a-script"
      id: bd53973d-cb69-4fd3-838f-093a8acec197
      iscommand: false
      name: Delete context
      script: DeleteContext
      type: regular
      version: -1
    taskid: bd53973d-cb69-4fd3-838f-093a8acec197
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 70,
          "y": -1500
        }
      }
  "181":
    continueonerrortype: ""
    id: "181"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "182"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: ab2861ef-0661-4556-82e8-ca82ca8247cd
      iscommand: false
      name: Slack Message
      type: title
      version: -1
    taskid: ab2861ef-0661-4556-82e8-ca82ca8247cd
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1470,
          "y": 960
        }
      }
  "182":
    continueonerrortype: ""
    id: "182"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "183"
    note: false
    quietmode: 0
    scriptarguments:
      gridfield:
        simple: asmplaybookstage
      keys:
        simple: stage,timestamp
      val1:
        simple: decision
      val2:
        simple: TIMESTAMP
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. Instead of a value, you can enter `TIMESTAMP` to get the current timestamp in ISO format.  Example of the command:
        `!GridFieldSetup keys=ip,src,timestamp val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" val3="TIMESTAMP" gridfiled="gridfield"`
      id: 98805312-6ca7-42e5-8c15-1d823f925f77
      iscommand: false
      name: Set playbook stage grid field (decision)
      script: GridFieldSetup
      type: regular
      version: -1
    taskid: 98805312-6ca7-42e5-8c15-1d823f925f77
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1470,
          "y": 1085
        }
      }
  "183":
    continueonerrortype: ""
    id: "183"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "184"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 27daf64d-b14d-4a42-8a5b-cf42d0953d35
      iscommand: false
      name: Notification Stage
      type: title
      version: -1
    taskid: 27daf64d-b14d-4a42-8a5b-cf42d0953d35
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1470,
          "y": 1580
        }
      }
  "184":
    continueonerrortype: ""
    id: "184"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 100
      wait: 1
    nexttasks:
      '#none#':
      - "134"
    note: false
    quietmode: 0
    scriptarguments:
      InstantMessageChannel:
        simple: ${inputs.InstantMessageChannel}
      OwnerNotificationBody:
        simple: ${inputs.OwnerNotificationBody}
      RemediationGuidance:
        simple: ${RemediationGuidance}
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      description: This playbook is used to create instant messages toward service
        owners to notify them of their internet exposures.
      id: 0f2ae625-39be-4cb7-8d21-7e1632aa18a0
      iscommand: false
      name: Cortex ASM - Instant Message
      playbookId: Cortex ASM - Instant Message
      type: playbook
      version: -1
    taskid: 0f2ae625-39be-4cb7-8d21-7e1632aa18a0
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 1470,
          "y": 1780
        }
      }
  "185":
    continueonerrortype: ""
    id: "185"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 0
      wait: 1
    nexttasks:
      '#none#':
      - "125"
    note: false
    quietmode: 0
    scriptarguments:
      AWSAssumeRoleName:
        simple: ${inputs.AWSAssumeRoleName}
      RemoteIP:
        complex:
          accessor: remoteip
          root: alert
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      id: 937819ab-91bd-438e-8329-4b00b1d6dfeb
      iscommand: false
      name: Cortex ASM - Enrichment
      playbookId: Cortex ASM - Enrichment
      type: playbook
      version: -1
    taskid: 937819ab-91bd-438e-8329-4b00b1d6dfeb
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 70,
          "y": -870
        }
      }
  "186":
    continueonerrortype: ""
    id: "186"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 0
      wait: 1
    nexttasks:
      '#none#':
      - "145"
    note: false
    quietmode: 0
    scriptarguments:
      BypassDevCheck:
        simple: ${inputs.BypassDevCheck}
      ExternallyDetectedProviders:
        simple: ${alert.asmprovider}
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      id: 3898edf1-25e6-484d-8f4e-572a9c84455c
      iscommand: false
      name: Cortex ASM - Remediation Path Rules
      playbookId: Cortex ASM - Remediation Path Rules
      type: playbook
      version: -1
    taskid: 3898edf1-25e6-484d-8f4e-572a9c84455c
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 70,
          "y": 480
        }
      }
  "187":
    continueonerrortype: ""
    id: "187"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    loop:
      exitCondition: ""
      iscommand: false
      max: 0
      wait: 1
    nexttasks:
      '#none#':
      - "164"
    note: false
    quietmode: 0
    scriptarguments:
      AWSAssumeRoleName:
        simple: ${inputs.AWSAssumeRoleName}
    separatecontext: true
    skipunavailable: false
    task:
      brand: ""
      id: 647b684a-7cfd-4edb-883d-4de8c9516d5b
      iscommand: false
      name: Cortex ASM - Remediation
      playbookId: Cortex ASM - Remediation
      type: playbook
      version: -1
    taskid: 647b684a-7cfd-4edb-883d-4de8c9516d5b
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": -690,
          "y": 1675
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {
      "110_111_Close Now": 0.88,
      "110_112_ Automated-Remediation": 0.88,
      "145_152_Manual Remediation": 0.68,
      "145_161_Jira Ticket": 0.87,
      "145_163_Notification Email": 0.74,
      "20_135_no": 0.53,
      "48_10_ServiceNow ticket": 0.82,
      "48_183_Slack message": 0.87,
      "48_60_Notification email": 0.88,
      "48_63_Manual remediation": 0.52
    },
    "paper": {
      "dimensions": {
        "height": 7105,
        "width": 2960,
        "x": -1110,
        "y": -1780
      }
    }
  }

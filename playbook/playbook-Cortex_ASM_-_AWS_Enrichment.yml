contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: 6.5.0
    itemVersion: 1.7.65
    packID: CortexAttackSurfaceManagement
    packName: Cortex Attack Surface Management
    packPropagationLabels:
    - all
    prevname: ""
    propagationLabels: []
    toServerVersion: ""
description: Given the IP address this playbook enriches AWS information relevant
  to ASM alerts.
id: Cortex ASM - AWS Enrichment
inputs:
- description: IP address of service
  key: RemoteIP
  playbookInputQuery: null
  required: false
  value:
    complex:
      accessor: remoteip
      root: alert
- description: Attack Surface Management Rule ID.
  key: ASMRuleID
  playbookInputQuery: null
  required: true
  value:
    complex:
      accessor: asmattacksurfaceruleid
      root: alert
- description: If assuming roles for AWS, this is the name of the role to assume (should
    be the same for all organizations).
  key: AWSAssumeRoleName
  playbookInputQuery: null
  required: false
  value: {}
name: Cortex ASM - AWS Enrichment
outputs: []
starttaskid: "0"
system: true
tasks:
  "0":
    continueonerrortype: ""
    id: "0"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "19"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: f2a59ef0-cb1e-4798-8bd4-32f87bdcb801
      iscommand: false
      name: ""
      version: -1
    taskid: f2a59ef0-cb1e-4798-8bd4-32f87bdcb801
    timertriggers: []
    type: start
    view: |-
      {
        "position": {
          "x": 450,
          "y": 0
        }
      }
  "1":
    continueonerrortype: ""
    id: "1"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "4"
      - "9"
      - "22"
      - "29"
      - "64"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 8eca27f9-7709-4c5c-85ea-9723f1ba9817
      iscommand: false
      name: Set Field
      type: title
      version: -1
    taskid: 8eca27f9-7709-4c5c-85ea-9723f1ba9817
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 450,
          "y": 330
        }
      }
  "2":
    continueonerrortype: ""
    id: "2"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "30"
    note: false
    quietmode: 0
    scriptarguments:
      gridfield:
        simple: asmprivateip
      keys:
        simple: ip,source
      val1:
        complex:
          accessor: PrivateIpAddress
          root: AWS.EC2.Instances.NetworkInterfaces
      val2:
        simple: AWS
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. For example:
        `!GridFieldSetup keys=ip,src val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" gridfiled="gridfield"`
      id: 7f2a1f3a-a3f2-4914-8757-5e8750a9954e
      iscommand: false
      name: Set private IP grid field
      script: GridFieldSetup
      type: regular
      version: -1
    taskid: 7f2a1f3a-a3f2-4914-8757-5e8750a9954e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 770,
          "y": 950
        }
      }
  "4":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: PrivateIpAddress
                root: AWS.EC2.Instances.NetworkInterfaces
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "4"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "32"
      "yes":
      - "15"
      - "6"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Determines if there is EC2 information to set the private IP, cloud,
        and tags fields.
      id: 14d35979-d26d-4475-811b-ca37e4fea28c
      iscommand: false
      name: Is there EC2 information?
      type: condition
      version: -1
    taskid: 14d35979-d26d-4475-811b-ca37e4fea28c
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 980,
          "y": 505
        }
      }
  "6":
    continueonerrortype: ""
    id: "6"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "2"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: b2537a81-ff0e-4dec-8e3c-d27d839bd677
      iscommand: false
      name: Private IP
      type: title
      version: -1
    taskid: b2537a81-ff0e-4dec-8e3c-d27d839bd677
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 770,
          "y": 795
        }
      }
  "8":
    continueonerrortype: ""
    id: "8"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "56"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 7c312963-025c-4236-8a8a-490376d80924
      iscommand: false
      name: System IDs
      type: title
      version: -1
    taskid: 7c312963-025c-4236-8a8a-490376d80924
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": -890,
          "y": 720
        }
      }
  "9":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Instances
                root: AWS.EC2
          operator: isNotEmpty
      - - left:
            iscontext: true
            value:
              complex:
                accessor: GroupId
                root: AWS.EC2.SecurityGroups
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "9"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "38"
      "yes":
      - "8"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Determines if there is EC2 and security group information to set
        in the system IDs field.
      id: a0c545b4-7ca6-4d1e-8ec4-9e7d5f906410
      iscommand: false
      name: Is there EC2 and security group information?
      type: condition
      version: -1
    taskid: a0c545b4-7ca6-4d1e-8ec4-9e7d5f906410
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -890,
          "y": 515
        }
      }
  "10":
    continueonerrortype: ""
    id: "10"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "11"
    note: false
    quietmode: 0
    scriptarguments:
      gridfield:
        simple: asmsystemids
      keys:
        simple: type,id,link
      val1:
        simple: ASSET-VIRTUAL-NET
      val2:
        complex:
          accessor: VpcId
          root: AWS.EC2.SecurityGroups
      val3:
        simple: n/a
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. For example:
        `!GridFieldSetup keys=ip,src val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" gridfiled="gridfield"`
      id: d5e9eeba-26f8-403e-82d4-d81ddb1b2862
      iscommand: false
      name: Set system IDs grid field (VPC)
      script: GridFieldSetup
      type: regular
      version: -1
    taskid: d5e9eeba-26f8-403e-82d4-d81ddb1b2862
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -890,
          "y": 1020
        }
      }
  "11":
    continueonerrortype: ""
    id: "11"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "12"
    note: false
    quietmode: 0
    scriptarguments:
      gridfield:
        simple: asmsystemids
      keys:
        simple: type,id,link
      val1:
        simple: ASSET-SG
      val2:
        complex:
          accessor: GroupId
          root: AWS.EC2.SecurityGroups
      val3:
        simple: n/a
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. For example:
        `!GridFieldSetup keys=ip,src val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" gridfiled="gridfield"`
      id: af4fcae6-fa3a-4036-86f2-a044c2e2b150
      iscommand: false
      name: Set system IDs grid field (SG)
      script: GridFieldSetup
      type: regular
      version: -1
    taskid: af4fcae6-fa3a-4036-86f2-a044c2e2b150
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -890,
          "y": 1190
        }
      }
  "12":
    continueonerrortype: ""
    id: "12"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "13"
    note: false
    quietmode: 0
    scriptarguments:
      gridfield:
        simple: asmsystemids
      keys:
        simple: type,id,link
      val1:
        simple: ASSET-SUBNET-ID
      val2:
        complex:
          accessor: SubnetId
          root: AWS.EC2.Instances
      val3:
        simple: n/a
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. For example:
        `!GridFieldSetup keys=ip,src val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" gridfiled="gridfield"`
      id: fa4088df-9a3a-4480-8e61-7672d7a4ea69
      iscommand: false
      name: Set system IDs grid field (subnet ID)
      script: GridFieldSetup
      type: regular
      version: -1
    taskid: fa4088df-9a3a-4480-8e61-7672d7a4ea69
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -890,
          "y": 1360
        }
      }
  "13":
    continueonerrortype: ""
    id: "13"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "14"
    note: false
    quietmode: 0
    scriptarguments:
      gridfield:
        simple: asmsystemids
      keys:
        simple: type,id,link
      val1:
        simple: ASSET-NIC
      val2:
        complex:
          accessor: NetworkInterfaceId
          root: AWS.EC2.Instances.NetworkInterfaces
      val3:
        simple: n/a
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. For example:
        `!GridFieldSetup keys=ip,src val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" gridfiled="gridfield"`
      id: aee30d2e-a57d-406f-8973-da95d14221b2
      iscommand: false
      name: Set system IDs grid field (NIC)
      script: GridFieldSetup
      type: regular
      version: -1
    taskid: aee30d2e-a57d-406f-8973-da95d14221b2
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -890,
          "y": 1540
        }
      }
  "14":
    continueonerrortype: ""
    id: "14"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "39"
    note: false
    quietmode: 0
    scriptarguments:
      gridfield:
        simple: asmsystemids
      keys:
        simple: type,id,link
      val1:
        simple: ASSET-ID
      val2:
        complex:
          accessor: InstanceId
          root: AWS.EC2.Instances
      val3:
        simple: n/a
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. For example:
        `!GridFieldSetup keys=ip,src val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" gridfiled="gridfield"`
      id: ff76595f-a547-4bff-8d63-e3a322dadc06
      iscommand: false
      name: Set system IDs grid field (EC2 ID)
      script: GridFieldSetup
      type: regular
      version: -1
    taskid: ff76595f-a547-4bff-8d63-e3a322dadc06
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -890,
          "y": 1710
        }
      }
  "15":
    continueonerrortype: ""
    id: "15"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "60"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 4bcc6bc5-345b-4561-8386-36c1f7622f90
      iscommand: false
      name: Cloud
      type: title
      version: -1
    taskid: 4bcc6bc5-345b-4561-8386-36c1f7622f90
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 1190,
          "y": 795
        }
      }
  "16":
    continueonerrortype: ""
    id: "16"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "62"
    note: false
    quietmode: 0
    scriptarguments:
      gridfield:
        simple: asmcloud
      keys:
        simple: provider,organization,project,region,other
      val1:
        simple: AWS
      val2:
        simple: ${org-id}
      val3:
        complex:
          accessor: OwnerId
          root: AWS.EC2.SecurityGroups
      val4:
        complex:
          accessor: Region
          root: AWS.EC2.Instances
      val5:
        complex:
          accessor: AvailabilityZone
          root: AWS.EC2.Instances.Placement
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. For example:
        `!GridFieldSetup keys=ip,src val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" gridfiled="gridfield"`
      id: b5715924-3d84-472a-8c05-65d6902a7ce0
      iscommand: false
      name: Set cloud grid field
      script: GridFieldSetup
      type: regular
      version: -1
    taskid: b5715924-3d84-472a-8c05-65d6902a7ce0
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1190,
          "y": 1300
        }
      }
  "17":
    continueonerrortype: ""
    id: "17"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "18"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 16fe96c8-1930-477e-8ab7-8b5fcce4efed
      iscommand: false
      name: Tags
      type: title
      version: -1
    taskid: 16fe96c8-1930-477e-8ab7-8b5fcce4efed
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 2080,
          "y": 795
        }
      }
  "18":
    continueonerrortype: ""
    id: "18"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "34"
    note: false
    quietmode: 0
    scriptarguments:
      gridfield:
        simple: asmtags
      keys:
        simple: key,value,source
      val1:
        complex:
          accessor: Key
          root: AWS.EC2.Instances.Tags
      val2:
        complex:
          accessor: Value
          root: AWS.EC2.Instances.Tags
      val3:
        simple: AWS
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. For example:
        `!GridFieldSetup keys=ip,src val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" gridfiled="gridfield"`
      id: d5122bf5-b3f5-42b7-8df4-a13c3be6f51e
      iscommand: false
      name: Set tags grid field
      script: GridFieldSetup
      type: regular
      version: -1
    taskid: d5122bf5-b3f5-42b7-8df4-a13c3be6f51e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2080,
          "y": 950
        }
      }
  "19":
    continueonerrortype: ""
    id: "19"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "1"
    note: false
    quietmode: 0
    scriptarguments:
      AWSAssumeRoleName:
        simple: ${inputs.AWSAssumeRoleName}
      AwsIP:
        complex:
          root: inputs.RemoteIP
    separatecontext: true
    skipunavailable: true
    task:
      brand: ""
      description: Given the IP address this playbook enriches EC2 and IAM information.
      id: fdf7bd3a-cb0d-4de5-8b17-5bfa14d2cfe3
      iscommand: false
      name: AWS - Enrichment
      playbookId: AWS - Enrichment
      type: playbook
      version: -1
    taskid: fdf7bd3a-cb0d-4de5-8b17-5bfa14d2cfe3
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": 450,
          "y": 170
        }
      }
  "20":
    continueonerrortype: ""
    id: "20"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "51"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 99e7c32f-4435-48a8-8f27-05f7f3de346f
      iscommand: false
      name: Closing Steps
      type: title
      version: -1
    taskid: 99e7c32f-4435-48a8-8f27-05f7f3de346f
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 460,
          "y": 2100
        }
      }
  "22":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: Key
                root: AWS.EC2.Instances.Tags
          operator: isNotEmpty
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "22"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "32"
      "yes":
      - "17"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Determines if there is EC2 tag information to set the tags fields.
      id: c43230f7-e626-4657-86c0-ca663895f99c
      iscommand: false
      name: Are there EC2 tags?
      type: condition
      version: -1
    taskid: c43230f7-e626-4657-86c0-ca663895f99c
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 2090,
          "y": 505
        }
      }
  "23":
    continueonerrortype: ""
    id: "23"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "24"
    note: false
    quietmode: 0
    separatecontext: true
    skipunavailable: true
    task:
      brand: ""
      description: The playbook sends a HTTP get response to the hostname and validates
        if there is missing bucket information.
      id: 8b5f68d9-28ff-4f5e-8330-93fd0c76919d
      iscommand: false
      name: AWS - Unclaimed S3 Bucket Validation
      playbookId: AWS - Unclaimed S3 Bucket Validation
      type: playbook
      version: -1
    taskid: 8b5f68d9-28ff-4f5e-8330-93fd0c76919d
    timertriggers: []
    type: playbook
    view: |-
      {
        "position": {
          "x": -1510,
          "y": 810
        }
      }
  "24":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: S3BucketName
          operator: isNotEmpty
      label: "yes"
    continueonerrortype: ""
    id: "24"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "41"
      "yes":
      - "57"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Determines if an S3 bucket was passed back or not.
      id: ea9e07e7-7ce3-41bc-86a5-17e0195a004b
      iscommand: false
      name: Was an S3 bucket passed back?
      type: condition
      version: -1
    taskid: ea9e07e7-7ce3-41bc-86a5-17e0195a004b
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -1510,
          "y": 995
        }
      }
  "28":
    continueonerrortype: ""
    id: "28"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "40"
    note: false
    quietmode: 0
    scriptarguments:
      gridfield:
        simple: asmsystemids
      keys:
        simple: type,id,link
      val1:
        simple: ASSET-ID
      val2:
        complex:
          root: S3BucketName
      val3:
        simple: n/a
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. For example:
        `!GridFieldSetup keys=ip,src val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" gridfiled="gridfield"`
      id: 6e45383f-a0d9-4c67-8ead-a718cb785920
      iscommand: false
      name: Set system IDs grid field (BucketName)
      script: GridFieldSetup
      type: regular
      version: -1
    taskid: 6e45383f-a0d9-4c67-8ead-a718cb785920
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -1510,
          "y": 1455
        }
      }
  "29":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: inputs.ASMRuleID
                transformers:
                - args:
                    chars:
                      value:
                        simple: '[\"]'
                  operator: StripChars
          operator: inList
          right:
            value:
              simple: UnclaimedS3Bucket
      label: Unclaimed S3 Bucket
    continueonerrortype: ""
    id: "29"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "41"
      Unclaimed S3 Bucket:
      - "23"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Determines the ASM sub-alert type for different scans.
      id: 2e89202d-f805-4a8d-8d34-dd3c0075d17f
      iscommand: false
      name: What is the sub-alert type?
      type: condition
      version: -1
    taskid: 2e89202d-f805-4a8d-8d34-dd3c0075d17f
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": -1390,
          "y": 505
        }
      }
  "30":
    continueonerrortype: ""
    id: "30"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "20"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: asm_enrichment_flag_aws
      value:
        simple: "true"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 083b4657-6d36-4ee6-8f3a-5aae7feafdec
      iscommand: false
      name: Set true flag for completed enrichment
      script: Set
      type: regular
      version: -1
    taskid: 083b4657-6d36-4ee6-8f3a-5aae7feafdec
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 770,
          "y": 1140
        }
      }
  "32":
    continueonerrortype: ""
    id: "32"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "20"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: asm_enrichment_flag_aws
      value:
        simple: "false"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 79d0de58-5b4f-428e-8d6e-ec8ce48f3288
      iscommand: false
      name: Set false flag for completed enrichment
      script: Set
      type: regular
      version: -1
    taskid: 79d0de58-5b4f-428e-8d6e-ec8ce48f3288
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1810,
          "y": 1490
        }
      }
  "33":
    continueonerrortype: ""
    id: "33"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "20"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: asm_enrichment_flag_aws
      value:
        simple: "true"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: be750499-2442-4db5-8d97-ba7b7e68b011
      iscommand: false
      name: Set true flag for completed enrichment
      script: Set
      type: regular
      version: -1
    taskid: be750499-2442-4db5-8d97-ba7b7e68b011
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1190,
          "y": 1635
        }
      }
  "34":
    continueonerrortype: ""
    id: "34"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "20"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: asm_enrichment_flag_aws
      value:
        simple: "true"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: bbbaa31e-c07e-4788-8e3a-a591a6bb57d2
      iscommand: false
      name: Set true flag for completed enrichment
      script: Set
      type: regular
      version: -1
    taskid: bbbaa31e-c07e-4788-8e3a-a591a6bb57d2
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 2080,
          "y": 1180
        }
      }
  "38":
    continueonerrortype: ""
    id: "38"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "20"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: asm_enrichment_flag_aws
      value:
        simple: "false"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: bcfc39b2-9ec1-47d9-8c59-372270fcc548
      iscommand: false
      name: Set false flag for completed enrichment
      script: Set
      type: regular
      version: -1
    taskid: bcfc39b2-9ec1-47d9-8c59-372270fcc548
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -430,
          "y": 1635
        }
      }
  "39":
    continueonerrortype: ""
    id: "39"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "20"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: asm_enrichment_flag_aws_ssm
      value:
        simple: "true"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: d5bf97bc-5f7e-4e2e-8d74-57be7f721dc0
      iscommand: false
      name: Set true flag for completed enrichment
      script: Set
      type: regular
      version: -1
    taskid: d5bf97bc-5f7e-4e2e-8d74-57be7f721dc0
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -890,
          "y": 1880
        }
      }
  "40":
    continueonerrortype: ""
    id: "40"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "20"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: asm_enrichment_flag_aws_s3
      value:
        simple: "true"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 6d6f9409-62c3-4c9d-8f84-e497b6497872
      iscommand: false
      name: Set true flag for completed enrichment
      script: Set
      type: regular
      version: -1
    taskid: 6d6f9409-62c3-4c9d-8f84-e497b6497872
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -1510,
          "y": 1865
        }
      }
  "41":
    continueonerrortype: ""
    id: "41"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "20"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: asm_enrichment_flag_aws_s3
      value:
        simple: "false"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: ee76e6eb-a96d-437d-8ef2-f5db8eadb783
      iscommand: false
      name: Set false flag for completed enrichment
      script: Set
      type: regular
      version: -1
    taskid: ee76e6eb-a96d-437d-8ef2-f5db8eadb783
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -1290,
          "y": 1635
        }
      }
  "43":
    continueonerrortype: ""
    id: "43"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "55"
    note: false
    quietmode: 0
    scriptarguments:
      gridfield:
        simple: asmenrichmentstatus
      keys:
        simple: source,record_exists,timestamp
      val1:
        simple: AWS S3
      val2:
        simple: "true"
      val3:
        simple: TIMESTAMP
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well.  Instead of a value you can enter `TIMESTAMP` to get the current timestamp in ISO format. For example:
        `!GridFieldSetup keys=ip,src,timestamp val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" val3="TIMESTAMP" gridfiled="gridfield"`
      id: 27a03fef-3842-46bb-81ba-0c3b556ff3c2
      iscommand: false
      name: Set ASM enrichment status to true (s3)
      script: GridFieldSetup
      type: regular
      version: -1
    taskid: 27a03fef-3842-46bb-81ba-0c3b556ff3c2
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 210,
          "y": 2630
        }
      }
  "44":
    continueonerrortype: ""
    id: "44"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "55"
    note: false
    quietmode: 0
    scriptarguments:
      gridfield:
        simple: asmenrichmentstatus
      keys:
        simple: source,record_exists,timestamp
      val1:
        simple: AWS
      val2:
        simple: "true"
      val3:
        simple: TIMESTAMP
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well.  Instead of a value you can enter `TIMESTAMP` to get the current timestamp in ISO format. For example:
        `!GridFieldSetup keys=ip,src,timestamp val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" val3="TIMESTAMP" gridfiled="gridfield"`
      id: 4afafe5c-7a00-4f78-8f0f-2ed2f09fe76c
      iscommand: false
      name: Set ASM enrichment status to true (AWS)
      script: GridFieldSetup
      type: regular
      version: -1
    taskid: 4afafe5c-7a00-4f78-8f0f-2ed2f09fe76c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 690,
          "y": 2630
        }
      }
  "51":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: asm_enrichment_flag_aws
          operator: containsGeneral
          right:
            value:
              simple: "true"
      - - left:
            iscontext: true
            value:
              complex:
                root: asm_enrichment_flag_aws_s3
          operator: containsGeneral
          right:
            value:
              simple: "true"
      label: Both
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: asm_enrichment_flag_aws_s3
          operator: containsGeneral
          right:
            value:
              simple: "true"
      label: S3
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                root: asm_enrichment_flag_aws
          operator: containsGeneral
          right:
            value:
              simple: "true"
      label: AWS (EC2)
    continueonerrortype: ""
    id: "51"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "53"
      AWS (EC2):
      - "44"
      Both:
      - "52"
      S3:
      - "43"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Check if enrichment was performed by checking for a value of true
        in the relevant flag variable.
      id: 94b9ccf0-0c2c-422c-80f0-ac07e330085d
      iscommand: false
      name: Was enrichment performed?
      type: condition
      version: -1
    taskid: 94b9ccf0-0c2c-422c-80f0-ac07e330085d
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 460,
          "y": 2230
        }
      }
  "52":
    continueonerrortype: ""
    id: "52"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "43"
      - "44"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 1381ba16-f89d-40b5-86e2-54143a790af2
      iscommand: false
      name: Both
      type: title
      version: -1
    taskid: 1381ba16-f89d-40b5-86e2-54143a790af2
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 460,
          "y": 2480
        }
      }
  "53":
    continueonerrortype: ""
    id: "53"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "54"
    note: false
    quietmode: 0
    scriptarguments:
      gridfield:
        simple: asmenrichmentstatus
      keys:
        simple: source,record_exists,timestamp
      val1:
        simple: AWS
      val2:
        simple: "false"
      val3:
        simple: TIMESTAMP
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well.  Instead of a value you can enter `TIMESTAMP` to get the current timestamp in ISO format. For example:
        `!GridFieldSetup keys=ip,src,timestamp val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" val3="TIMESTAMP" gridfiled="gridfield"`
      id: 32d50c6b-2f9a-4302-829b-8c5aee0ca3c2
      iscommand: false
      name: Set ASM enrichment status to false (AWS)
      script: GridFieldSetup
      type: regular
      version: -1
    taskid: 32d50c6b-2f9a-4302-829b-8c5aee0ca3c2
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 450,
          "y": 2780
        }
      }
  "54":
    continueonerrortype: ""
    id: "54"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "55"
    note: false
    quietmode: 0
    scriptarguments:
      gridfield:
        simple: asmenrichmentstatus
      keys:
        simple: source,record_exists,timestamp
      val1:
        simple: AWS S3
      val2:
        simple: "false"
      val3:
        simple: TIMESTAMP
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well.  Instead of a value you can enter `TIMESTAMP` to get the current timestamp in ISO format. For example:
        `!GridFieldSetup keys=ip,src,timestamp val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" val3="TIMESTAMP" gridfiled="gridfield"`
      id: f946c5cc-65b6-4e5d-86ee-f730fe0ea9ad
      iscommand: false
      name: Set ASM enrichment status to false (s3)
      script: GridFieldSetup
      type: regular
      version: -1
    taskid: f946c5cc-65b6-4e5d-86ee-f730fe0ea9ad
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 450,
          "y": 2970
        }
      }
  "55":
    continueonerrortype: ""
    id: "55"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      id: 37aea528-4d0b-4237-82e9-9f15d40007c0
      iscommand: false
      name: Complete
      type: title
      version: -1
    taskid: 37aea528-4d0b-4237-82e9-9f15d40007c0
    timertriggers: []
    type: title
    view: |-
      {
        "position": {
          "x": 450,
          "y": 3220
        }
      }
  "56":
    continueonerrortype: ""
    id: "56"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "10"
    note: false
    quietmode: 0
    scriptarguments:
      gridfield:
        simple: asmsystemids
      keys:
        simple: type,id,link
      val1:
        simple: ASSET-TYPE
      val2:
        simple: AWS EC2
      val3:
        simple: n/a
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: Sets the type of cloud asset to the grid field for the ASM system
        IDs object.
      id: aefccfa5-4c36-4a60-8aec-0df67d820a0c
      iscommand: false
      name: Set system IDs grid field (type)
      script: GridFieldSetup
      type: regular
      version: -1
    taskid: aefccfa5-4c36-4a60-8aec-0df67d820a0c
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -890,
          "y": 855
        }
      }
  "57":
    continueonerrortype: ""
    id: "57"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "28"
    note: false
    quietmode: 0
    scriptarguments:
      gridfield:
        simple: asmsystemids
      keys:
        simple: type,id,link
      val1:
        simple: ASSET-TYPE
      val2:
        simple: AWS S3
      val3:
        simple: n/a
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. For example:
        `!GridFieldSetup keys=ip,src val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" gridfiled="gridfield"`
      id: 7df56655-292b-4db0-8d27-a2724d72203b
      iscommand: false
      name: Set system IDs grid field (type)
      script: GridFieldSetup
      type: regular
      version: -1
    taskid: 7df56655-292b-4db0-8d27-a2724d72203b
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": -1510,
          "y": 1235
        }
      }
  "58":
    continueonerrortype: ""
    id: "58"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "16"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: org-id
      value:
        complex:
          accessor: arn
          filters:
          - - left:
                iscontext: true
                value:
                  simple: AWSHierarchy.level
              operator: isEqualString
              right:
                value:
                  simple: account
          root: AWSHierarchy
          transformers:
          - args:
              from:
                value:
                  simple: account/
              to:
                value:
                  simple: /
            operator: ExtractInbetween
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 8196e4aa-6d02-4315-848f-ff9487841f41
      iscommand: false
      name: Set org
      script: Set
      type: regular
      version: -1
    taskid: 8196e4aa-6d02-4315-848f-ff9487841f41
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1190,
          "y": 1130
        }
      }
  "59":
    continueonerrortype: ""
    id: "59"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "16"
    note: false
    quietmode: 0
    scriptarguments:
      key:
        simple: org-id
      value:
        simple: n/a
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: 9d212a96-b43b-46a7-8417-0e836cd68a79
      iscommand: false
      name: Set org to n/a
      script: Set
      type: regular
      version: -1
    taskid: 9d212a96-b43b-46a7-8417-0e836cd68a79
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1590,
          "y": 1130
        }
      }
  "60":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                accessor: id
                filters:
                - - left:
                      iscontext: true
                      value:
                        simple: AWSHierarchy.level
                    operator: isEqualString
                    right:
                      value:
                        simple: account
                root: AWSHierarchy
          operator: isNotEmpty
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "60"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "59"
      "yes":
      - "58"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Determines if there is AWS organization information to set in the
        cloud field.
      id: d47da135-9824-4f1a-8f35-9f955ae78114
      iscommand: false
      name: Is there an organization id?
      type: condition
      version: -1
    taskid: d47da135-9824-4f1a-8f35-9f955ae78114
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 1190,
          "y": 950
        }
      }
  "62":
    continueonerrortype: ""
    id: "62"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "33"
    note: false
    quietmode: 0
    scriptarguments:
      asmassethierarchy:
        complex:
          accessor: name
          root: AWSHierarchy
          transformers:
          - operator: ReverseList
          - args:
              separator:
                value:
                  simple: /
            operator: join
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: commands.local.cmd.set.incident
      id: 67f0fcb4-0526-4c92-80be-4f89df7ec211
      iscommand: true
      name: Set hierarchy field
      script: Builtin|||setAlert
      type: regular
      version: -1
    taskid: 67f0fcb4-0526-4c92-80be-4f89df7ec211
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 1190,
          "y": 1470
        }
      }
  "64":
    conditions:
    - condition:
      - - left:
            iscontext: true
            value:
              complex:
                filters:
                - - left:
                      iscontext: true
                      value:
                        simple: AWS.SSM.InventoryEntry.Entries.[0].InstanceStatus
                    operator: isEqualString
                    right:
                      value:
                        simple: Active
                root: AWS.SSM
          operator: isNotEmpty
          right:
            value: {}
      label: "yes"
    continueonerrortype: ""
    id: "64"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#default#':
      - "72"
      "yes":
      - "65"
    note: false
    quietmode: 0
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Determines if there is SSM information to set in the system IDs
        field.
      id: 31a242a0-5a16-433c-8034-e9712abe8f9a
      iscommand: false
      name: Is there AWS SSM information?
      type: condition
      version: -1
    taskid: 31a242a0-5a16-433c-8034-e9712abe8f9a
    timertriggers: []
    type: condition
    view: |-
      {
        "position": {
          "x": 40,
          "y": 515
        }
      }
  "65":
    continueonerrortype: ""
    id: "65"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "66"
    note: false
    quietmode: 0
    scriptarguments:
      gridfield:
        simple: asmsystemids
      keys:
        simple: type,id,link
      val1:
        simple: ASSET-TYPE
      val2:
        simple: AWS-SSM
      val3:
        simple: n/a
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: Sets the type of cloud asset to the grid field for the ASM system
        IDs object.
      id: 627c9db8-e0bf-4d1e-87c2-de7a9b566d8a
      iscommand: false
      name: Set system IDs grid field (type)
      script: GridFieldSetup
      type: regular
      version: -1
    taskid: 627c9db8-e0bf-4d1e-87c2-de7a9b566d8a
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 40,
          "y": 720
        }
      }
  "66":
    continueonerrortype: ""
    id: "66"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "67"
    note: false
    quietmode: 0
    scriptarguments:
      gridfield:
        simple: asmsystemids
      keys:
        simple: type,id,link
      val1:
        simple: ASSET-SSM-AGENT-STATUS
      val2:
        complex:
          accessor: Entries
          root: AWS.SSM.InventoryEntry
          transformers:
          - operator: FirstArrayElement
          - args:
              field:
                value:
                  simple: InstanceStatus
            operator: getField
      val3:
        simple: n/a
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. For example:
        `!GridFieldSetup keys=ip,src val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" gridfiled="gridfield"`
      id: b685526c-05d1-49a6-8976-54cec87051fd
      iscommand: false
      name: Set system IDs grid field (SSMAgentStatus)
      script: GridFieldSetup
      type: regular
      version: -1
    taskid: b685526c-05d1-49a6-8976-54cec87051fd
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 40,
          "y": 880
        }
      }
  "67":
    continueonerrortype: ""
    id: "67"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "68"
    note: false
    quietmode: 0
    scriptarguments:
      gridfield:
        simple: asmsystemids
      keys:
        simple: type,id,link
      val1:
        simple: ASSET-SSM-ID
      val2:
        complex:
          accessor: Entries
          root: AWS.SSM.InventoryEntry
          transformers:
          - operator: FirstArrayElement
          - args:
              field:
                value:
                  simple: InstanceId
            operator: getField
      val3:
        simple: n/a
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. For example:
        `!GridFieldSetup keys=ip,src val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" gridfiled="gridfield"`
      id: 6b837a41-225c-4a41-880d-e04829a897db
      iscommand: false
      name: Set system IDs grid field (SSMInstanceID)
      script: GridFieldSetup
      type: regular
      version: -1
    taskid: 6b837a41-225c-4a41-880d-e04829a897db
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 40,
          "y": 1055
        }
      }
  "68":
    continueonerrortype: ""
    id: "68"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "69"
    note: false
    quietmode: 0
    scriptarguments:
      gridfield:
        simple: asmsystemids
      keys:
        simple: type,id,link
      val1:
        simple: ASSET-SSM-PLATFORM-NAME
      val2:
        complex:
          accessor: Entries
          root: AWS.SSM.InventoryEntry
          transformers:
          - operator: FirstArrayElement
          - args:
              field:
                value:
                  simple: PlatformName
            operator: getField
      val3:
        simple: n/a
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. For example:
        `!GridFieldSetup keys=ip,src val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" gridfiled="gridfield"`
      id: 0385d4a3-a23d-4cbc-8bdb-bb49f09687bd
      iscommand: false
      name: Set system IDs grid field (SSMPlatformName)
      script: GridFieldSetup
      type: regular
      version: -1
    taskid: 0385d4a3-a23d-4cbc-8bdb-bb49f09687bd
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 40,
          "y": 1235
        }
      }
  "69":
    continueonerrortype: ""
    id: "69"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "70"
    note: false
    quietmode: 0
    scriptarguments:
      gridfield:
        simple: asmsystemids
      keys:
        simple: type,id,link
      val1:
        simple: ASSET-SSM-PLATFORM-TYPE
      val2:
        complex:
          accessor: Entries
          root: AWS.SSM.InventoryEntry
          transformers:
          - operator: FirstArrayElement
          - args:
              field:
                value:
                  simple: PlatformType
            operator: getField
      val3:
        simple: n/a
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. For example:
        `!GridFieldSetup keys=ip,src val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" gridfiled="gridfield"`
      id: d261ca8f-cb4e-4a63-8879-fc8b88e79b57
      iscommand: false
      name: Set system IDs grid field (SSMPlatformType)
      script: GridFieldSetup
      type: regular
      version: -1
    taskid: d261ca8f-cb4e-4a63-8879-fc8b88e79b57
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 40,
          "y": 1395
        }
      }
  "70":
    continueonerrortype: ""
    id: "70"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "71"
    note: false
    quietmode: 0
    scriptarguments:
      gridfield:
        simple: asmsystemids
      keys:
        simple: type,id,link
      val1:
        simple: ASSET-SSM-PLATFORM-VERSION
      val2:
        complex:
          accessor: Entries
          root: AWS.SSM.InventoryEntry
          transformers:
          - operator: FirstArrayElement
          - args:
              field:
                value:
                  simple: PlatformVersion
            operator: getField
      val3:
        simple: n/a
    separatecontext: false
    skipunavailable: false
    task:
      brand: Builtin
      description: |-
        Automation used to more easily populate a grid field. This is necessary when you want to assign certain values as static or if you have context paths that you will assign to different values as well. For example:
        `!GridFieldSetup keys=ip,src val1=${AWS.EC2.Instances.NetworkInterfaces.PrivateIpAddress} val2="AWS" gridfiled="gridfield"`
      id: a84f696e-8f71-45a0-8878-b1235db97942
      iscommand: false
      name: Set system IDs grid field (SSMPlatformVersion)
      script: GridFieldSetup
      type: regular
      version: -1
    taskid: a84f696e-8f71-45a0-8878-b1235db97942
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 40,
          "y": 1565
        }
      }
  "71":
    continueonerrortype: ""
    id: "71"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "20"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: asm_enrichment_flag_aws_ssm
      value:
        simple: "true"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: a8d26022-1fc4-4030-87e4-be61c8133b4e
      iscommand: false
      name: Set true flag for completed enrichment
      script: Set
      type: regular
      version: -1
    taskid: a8d26022-1fc4-4030-87e4-be61c8133b4e
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 40,
          "y": 1730
        }
      }
  "72":
    continueonerrortype: ""
    id: "72"
    ignoreworker: false
    isautoswitchedtoquietmode: false
    isoversize: false
    nexttasks:
      '#none#':
      - "20"
    note: false
    quietmode: 0
    scriptarguments:
      append:
        simple: "true"
      key:
        simple: asm_enrichment_flag_aws_ssm
      value:
        simple: "false"
    separatecontext: false
    skipunavailable: false
    task:
      brand: ""
      description: Set a value in context under the key you entered.
      id: ca8eb5bb-d6c2-4cbc-8633-d2d62d1e2466
      iscommand: false
      name: Set false flag for completed enrichment
      script: Set
      type: regular
      version: -1
    taskid: ca8eb5bb-d6c2-4cbc-8633-d2d62d1e2466
    timertriggers: []
    type: regular
    view: |-
      {
        "position": {
          "x": 460,
          "y": 1340
        }
      }
version: -1
view: |-
  {
    "linkLabelsPosition": {
      "22_32_#default#": 0.32,
      "24_41_#default#": 0.23,
      "29_23_Unclaimed S3 Bucket": 0.71,
      "29_41_#default#": 0.54,
      "51_52_Both": 0.4
    },
    "paper": {
      "dimensions": {
        "height": 3285,
        "width": 3980,
        "x": -1510,
        "y": 0
      }
    }
  }

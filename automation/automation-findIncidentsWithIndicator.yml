args:
- default: true
  description: Indicator to search for.
  name: indicator
  required: true
comment: "Lookup incidents with specified indicator. Use currentIncidentId to omit
  the existing incident from output.\n\nThis automation runs using the default Limited
  User role, unless you explicitly change the permissions.\nFor more information,
  see the section about permissions here:\n- For Cortex see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.x/Cortex-XSOAR-Playbook-Design-Guide/Automations
  \n- For Cortex Cloud see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8/Cortex-XSOAR-Cloud-Documentation/Create-a-script\n-
  For Cortex.7 On-prem see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8.7/Cortex-XSOAR-On-prem-Documentation/Create-a-script"
commonfields:
  id: findIncidentsWithIndicator
  version: -1
contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: 5.0.0
    itemVersion: 1.19.10
    packID: CommonScripts
    packName: Common Scripts
    packPropagationLabels:
    - all
    prevname: ""
    propagationLabels: []
    toServerVersion: ""
deprecated: true
enabled: true
engineinfo: {}
mainengineinfo: {}
name: findIncidentsWithIndicator
outputs:
- contextPath: IncidentsWithIndicator.Indicator
  description: Indicator that was found in other incidents.
- contextPath: IncidentsWithIndicator.incidentIDs
  description: Incident IDs that the indicator was found in.
pswd: ""
runas: DBotWeakRole
runonce: false
script: |
  return executeCommand('findAlertsWithIndicator', args)
scripttarget: 0
system: true
tags:
- Utility
type: javascript

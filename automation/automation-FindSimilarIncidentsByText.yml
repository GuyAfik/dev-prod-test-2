args:
- defaultValue: name,details
  description: 'Text fields to compare. Can be label name, incident fields or custom
    fields. Comma separated value. '
  name: textFields
  required: true
- defaultValue: "0.95"
  description: TFIDF score threshold (to consider incident as similar).
  name: threshold
- defaultValue: "1000"
  description: Maximum number of incidents to check.
  name: maximumNumberOfIncidents
- defaultValue: "72"
  description: Check incidents in this time frame.
  name: timeFrameHours
- auto: PREDEFINED
  defaultValue: "no"
  description: Ignore close incidents.
  name: ignoreClosedIncidents
  predefined:
  - "yes"
  - "no"
- auto: PREDEFINED
  defaultValue: occurred
  description: Time field to consider.
  name: timeField
  predefined:
  - occurred
  - created
  - modified
- defaultValue: "10"
  description: Maximum number of similar candidates.
  name: maxResults
- defaultValue: "50"
  description: Minimum required text length to compare.
  name: minTextLength
- auto: PREDEFINED
  defaultValue: "false"
  description: Whether to pre-process text (removing HTML, normilize words)
  name: preProcessText
  predefined:
  - "true"
  - "false"
comment: "Deprecated. Use DBotFindSimilarIncidents instead.\nFind similar incidents
  by text comparison - the algorithm based on TF-IDF method.\nTo read more about this
  method: https://en.wikipedia.org/wiki/Tf%E2%80%93idf\n\nThis automation runs using
  the default Limited User role, unless you explicitly\nchange the permissions.\nFor
  more information, see the section about permissions here:\n- For Cortex see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/6.x/Cortex-XSOAR-Playbook-Design-Guide/Automations
  \n- For Cortex Cloud see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8/Cortex-XSOAR-Cloud-Documentation/Create-a-script\n-
  For Cortex.7 On-prem see https://docs-cortex.paloaltonetworks.com/r/Cortex-XSOAR/8.7/Cortex-XSOAR-On-prem-Documentation/Create-a-script"
commonfields:
  id: FindSimilarIncidentsByText
  version: -1
contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: 5.0.0
    itemVersion: 1.39.16
    packID: Base
    packName: Base
    packPropagationLabels:
    - all
    prevname: ""
    propagationLabels: []
    toServerVersion: ""
deprecated: true
dockerimage: demisto/sklearn:1.0.0.49796
enabled: true
engineinfo: {}
mainengineinfo: {}
name: FindSimilarIncidentsByText
outputs:
- contextPath: similarIncident.rawId
  description: Similar incident ID.
  type: string
- contextPath: isSimilarIncidentFound
  description: Is similar incident found? (true\false)
  type: boolean
- contextPath: similarIncident
  description: Similar incident.
  type: Unknown
- contextPath: similarIncident.name
  description: Similar incident name.
  type: string
pswd: ""
runas: DBotWeakRole
runonce: true
script: |-
  register_module_line('FindSimilarIncidentsByText', 'start', __line__())

  return_results(demisto.executeCommand('FindSimilarAlertsByText', demisto.args()))

  register_module_line('FindSimilarIncidentsByText', 'end', __line__())
scripttarget: 0
subtype: python3
system: true
tags:
- ml
- dedup
- duplicate
- incidents
type: python

args:
- description: Number of days or hours
  name: number
- auto: PREDEFINED
  name: unit
  predefined:
  - DAYS
  - HOURS
commonfields:
  id: f4d2ce5a-4e15-4045-859c-eb8f858ac9ea
  version: -1
contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
dockerimage: demisto/panw-iot:1.0.0.79918
enabled: true
engineinfo: {}
mainengineinfo: {}
name: GetLastDateTimeTenable
outputs:
- contextPath: PANWIoTCloud.DateTimeDelta
  description: DateTime of last no of days
pswd: ""
runas: DBotWeakRole
runonce: false
script: |
  register_module_line('GetLastDateTimeTenable', 'start', __line__())


  import datetime

  def get_last_no_of_days_date_time():
      number = int(demisto.args().get('number'))
      unit = demisto.args().get('unit')
      now = datetime.datetime.now()
      deltaDateTime=None
      delta_time_format=None
      if unit == 'DAYS':
         deltaDateTime = now - datetime.timedelta(days=number)
         delta_time_format = str(deltaDateTime.strftime("%Y-%m-%d"))
      else:
          deltaDateTime = now - datetime.timedelta(hours=number)
          delta_time_format = str(deltaDateTime.strftime("%Y-%m-%d %H:%M:%S"))

      return delta_time_format

  def main():
      try:
          time=get_last_no_of_days_date_time()
          appendContext('PANWIoTCloud.DateTimeDelta', time)
          return_results(time)
      except Exception as ex:
          demisto.error(traceback.format_exc())  # print the traceback
          return_error(f'Failed to execute GetLastDateTime. Error: {str(ex)}')

  ''' ENTRY POINT '''
  if __name__ in ('__main__', '__builtin__', 'builtins'):
      main()

  register_module_line('GetLastDateTimeTenable', 'end', __line__())
scripttarget: 0
subtype: python3
tags:
- PANW IoT 3rd Party Integration
- tenable
type: python

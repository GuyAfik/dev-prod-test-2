args:
- description: Authorization Profile Name
  name: name
  required: true
- description: Authorization Profile Content
  name: content
  required: true
- description: Cisco active instance
  name: active_ise_instance
  required: true
commonfields:
  id: 1d49e0cc-bff0-40af-851b-aa816cbf34d2
  version: -1
contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
dockerimage: demisto/panw-iot:1.0.0.79918
enabled: true
engineinfo: {}
mainengineinfo: {}
name: CreateOrUpdateAuthorizationProfileToCiscoISEFromWLC
pswd: ""
runas: DBotWeakRole
runonce: false
script: |
  register_module_line('CreateOrUpdateAuthorizationProfileToCiscoISEFromWLC', 'start', __line__())




  import json
  CISCO_ISE_ACTIVE_INSTANCE = demisto.args().get("active_ise_instance")


  def create_update_auth_profile():
      try:
          authProfileName = demisto.args().get('name')
          content = demisto.args().get('content')

          if not isinstance(content, dict):
              content = json.loads(content)


          formatted_content = {"airespaceACL": content.get("wlc")}

          if 'dACL' in content:
              formatted_content["daclName"] = content.get("dACL")


          auth_res = demisto.executeCommand("CreateOrUpdateAuthorizationProfileToCiscoISE",
                                            {"name": authProfileName, "active_ise_instance": CISCO_ISE_ACTIVE_INSTANCE, "content": formatted_content})

          if isError(auth_res[0]):
              raise Exception(auth_res[0]['Contents'])

          return auth_res[0]['Contents']
      except Exception as e:
          raise Exception(traceback.format_exc())


  def main():
      try:
          return_results(create_update_auth_profile())
      except Exception as ex:
          return_error(str(ex))


  if __name__ in ('__main__', '__builtin__', 'builtins'):
      main()

  register_module_line('CreateOrUpdateAuthorizationProfileToCiscoISEFromWLC', 'end', __line__())
scripttarget: 0
subtype: python3
tags:
- Cisco ISE
type: python

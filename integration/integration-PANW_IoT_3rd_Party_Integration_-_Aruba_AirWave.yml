category: Network Security
commonfields:
  id: PANW IoT 3rd Party Integration - Aruba AirWave
  version: -1
configuration:
- additionalinfo: Aruba AirWave IP address or Hostname
  display: Aruba Airwave IP or Hostname
  name: server_url
  required: true
  type: 0
- display: Username
  name: username
  required: true
  type: 0
- display: Password
  name: password
  required: true
  type: 4
contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
description: Aruba AirWave is a multi-vendor network management system for configuring,
  monitoring, and maintaining wired and wireless networks at scale.
detaileddescription: |-
  ## Aruba Airwave integration

  Please configure the instance by providing following details:

  - Name of the instance
  - Aruba Airwave IP or Hostname
  - User name for log in
  - Password associated with the user account

  ## Test Configuration

  After providing the mandatory details, please test the configuration using the Test button.

  ---
  [View Integration Documentation](https://xsoar.pan.dev/docs/reference/integrations/aruba-wlan-controller)
display: PANW IoT 3rd Party Integration - Aruba AirWave
image: data:image/png;base64,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
name: PANW IoT 3rd Party Integration - Aruba AirWave
script:
  commands:
  - arguments: []
    name: aruba-airwave-vrf-get-campuses
  - arguments:
    - name: site_id
    name: aruba-airwave-vrf-get-client-locations
  - arguments:
    - name: mac_address
    name: aruba-airwave-get-client-details
  - arguments:
    - name: site_id
    name: aruba-airwave-vrf-get-ap-locations
  - arguments: []
    name: aruba-airwave-get-ap-list
  - arguments: []
    name: aruba-airwave-vrf-get-buildings
  - arguments:
    - name: image_url
      required: true
    - name: filename
      required: true
    name: aruba-airwave-vrf-download-image
    outputs:
    - contextPath: InfoFile.EntryId
  dockerimage: demisto/netmiko:1.0.0.23064
  runonce: false
  script: |
    register_module_line('PANW IoT 3rd Party Integration - Aruba AirWave', 'start', __line__())




    import re
    import json
    import collections
    import sys
    from time import gmtime, strftime
    import time
    import socket
    import requests
    from xml.etree import ElementTree

    SERVER_URL = demisto.params().get("server_url")
    if not SERVER_URL.endswith("/"):
        SERVER_URL = SERVER_URL + "/"
    if not SERVER_URL.startswith("https://") and not SERVER_URL.startswith("http://"):
        SERVER_URL = "https://" + SERVER_URL
    USERNAME = demisto.params().get("username")
    PASSWORD = demisto.params().get("password")

    class XmlDictObject(dict):
        """
        Adds object like functionality to the standard dictionary.
        """

        def __init__(self, initdict=None):
            if initdict is None:
                initdict = {}
            dict.__init__(self, initdict)

        def __getattr__(self, item):
            return self.__getitem__(item)

        def __setattr__(self, item, value):
            self.__setitem__(item, value)

        def __str__(self):
            if '_text' in self:
                return self.__getitem__('_text')
            else:
                return ''

        @staticmethod
        def Wrap(x):
            """
            Static method to wrap a dictionary recursively as an XmlDictObject
            """

            if isinstance(x, dict):
                return XmlDictObject((k, XmlDictObject.Wrap(v)) for (k, v) in list(x.items()))
            elif isinstance(x, list):
                return [XmlDictObject.Wrap(v) for v in x]
            else:
                return x

        @staticmethod
        def _UnWrap(x):
            if isinstance(x, dict):
                return dict((k, XmlDictObject._UnWrap(v)) for (k, v) in list(x.items()))
            elif isinstance(x, list):
                return [XmlDictObject._UnWrap(v) for v in x]
            else:
                return x

        def UnWrap(self):
            """
            Recursively converts an XmlDictObject to a standard dictionary and returns the result.
            """

            return XmlDictObject._UnWrap(self)

    def _ConvertDictToXmlRecurse(parent, dictitem):
        assert type(dictitem) is not type([])

        if isinstance(dictitem, dict):
            for (tag, child) in list(dictitem.items()):
                if str(tag) == '_text':
                    parent.text = str(child)
                elif type(child) is type([]):
                    # iterate through the array and convert
                    for listchild in child:
                        elem = ElementTree.Element(tag)
                        parent.append(elem)
                        _ConvertDictToXmlRecurse(elem, listchild)
                else:
                    elem = ElementTree.Element(tag)
                    parent.append(elem)
                    _ConvertDictToXmlRecurse(elem, child)
        else:
            parent.text = str(dictitem)

    def ConvertDictToXml(xmldict):
        """
        Converts a dictionary to an XML ElementTree Element
        """

        roottag = list(xmldict.keys())[0]
        root = ElementTree.Element(roottag)
        _ConvertDictToXmlRecurse(root, xmldict[roottag])
        return root

    def _ConvertXmlToDictRecurse(node, dictclass):
        nodedict = dictclass()

        if len(list(node.items())) > 0:
            # if we have attributes, set them
            nodedict.update(dict(list(node.items())))

        for child in node:
            # recursively add the element's children
            newitem = _ConvertXmlToDictRecurse(child, dictclass)
            if child.tag in nodedict:
                # found duplicate tag, force a list
                if type(nodedict[child.tag]) is type([]):
                    # append to existing list
                    nodedict[child.tag].append(newitem)
                else:
                    # convert to list
                    nodedict[child.tag] = [nodedict[child.tag], newitem]
            else:
                # only one, directly set the dictionary
                nodedict[child.tag] = newitem

        if node.text is None:
            text = ''
        else:
            text = node.text.strip()

        if len(nodedict) > 0:
            # if we have a dictionary add the text as a dictionary value (if there is any)
            if len(text) > 0:
                nodedict['_text'] = text
        else:
            # if we don't have child nodes or attributes, just set the text
            nodedict = text

        return nodedict

    def ConvertXmlToDict(root, dictclass=XmlDictObject):
        """
        Converts an XML file or ElementTree Element to a dictionary
        """
        # If a string is passed in, try to open it as a file
        if type(root) == type(''):
            root = ElementTree.parse(root).getroot()
        elif not isinstance(root, ElementTree.Element):
            raise TypeError('Expected ElementTree.Element or file path string')

        return dictclass({root.tag: _ConvertXmlToDictRecurse(root, dictclass)})

    class AirWaveAPIClient(object):
        def __init__(self):
            self.username = USERNAME
            self.password = PASSWORD
            self.url = SERVER_URL
            self.session = None

        def login(self):
            requests.packages.urllib3.disable_warnings()
            self.session = requests.Session()
            url = self.url + '/LOGIN'
            destination = '/'
            next_action = ''
            params = {'credential_0': self.username,
                      'credential_1': self.password,
                      'login': 'Log In',
                      'destination': destination,
                      'next_action': next_action}
            return self.session.post(url, params=params, verify=False)

        def ap_list(self):
            url = self.url + '/ap_list.xml'
            response = self.session.get(url, verify=False)
            root = ElementTree.XML(response.text)
            ap_list = ConvertXmlToDict(root)
            if ap_list is not None and ap_list != None:
                ap_list = ap_list.UnWrap()
            return ap_list

        def client_details(self, mac_address):
            if not mac_address or not is_mac_address(mac_address):
                return None
            url = self.url + '/client_detail.xml?mac=%s&limit=1' % mac_address.upper()
            response = self.session.get(url, verify=False)
            root = ElementTree.XML(response.text)
            client_details = ConvertXmlToDict(root)
            if client_details is not None and client_details != None:
                client_details = client_details.UnWrap()
            return client_details

        def client_locations(self, site_id=None):
            if site_id:
                url = self.url + '/visualrf/site.xml?id=%s&clients=&' % site_id
            else:
                url = self.url + '/visualrf/site.xml?clients=&'
            response = self.session.get(url, verify=False)
            root = ElementTree.XML(response.text)
            client_locations = ConvertXmlToDict(root)
            if client_locations is not None and client_locations != None:
                client_locations = client_locations.UnWrap()
            return client_locations

        def ap_locations(self, site_id=None):
            if site_id:
                url = self.url + '/visualrf/site.xml?id=%s&aps=&' % site_id
            else:
                url = self.url + '/visualrf/site.xml?aps=&'
            response = self.session.get(url, verify=False)
            root = ElementTree.XML(response.text)
            ap_locations = ConvertXmlToDict(root)
            if ap_locations is not None and ap_locations != None:
                ap_locations = ap_locations.UnWrap()
            return ap_locations

        def campus_details(self):
            url = self.url + '/visualrf/campus.xml?buildings=&sites=&images=&properties=&'
            response = self.session.get(url, verify=False)
            root = ElementTree.XML(response.text)
            campus_details = ConvertXmlToDict(root)
            if campus_details is not None and campus_details != None:
                campus_details = campus_details.UnWrap()
            return campus_details

        def building_details(self):
            url = self.url + '/visualrf/building.xml?sites=&images=&properties=&'
            response = self.session.get(url, verify=False)
            root = ElementTree.XML(response.text)
            building_details = ConvertXmlToDict(root)
            if building_details is not None and building_details != None:
                building_details = building_details.UnWrap()
            return building_details

        def vrf_image_download(self, image_url, filename):
            if not image_url or not filename:
                return None
            url = self.url + image_url
            filename = filename.split("/")[-1]
            downloaded_image = 'downloaded_image'
            response = self.session.get(url, verify=False)
            if response.status_code == 200:
                downloaded_image = response.content
            else:
                return None
            file_entry = fileResult(filename, downloaded_image, EntryType.ENTRY_INFO_FILE)
            return file_entry

    def main() -> None:
        """
            main function, parses params and runs command functions
        """
        args = demisto.args()
        demisto.debug(f'Command being called is {demisto.command()}')
        try:
            aruba_client = AirWaveAPIClient()
            login = aruba_client.login()
            # The command demisto.command() holds the command sent from the user.
            if demisto.command() == 'test-module':
                if 200 == login.status_code:
                    demisto.results ('ok')
                else:
                    demisto.results ("Connection Test Failed. [%s] [%s]" % (login.status_code, login.content))
            elif demisto.command() == 'aruba-airwave-vrf-get-campuses':
                return_results(aruba_client.campus_details())
            elif demisto.command() == 'aruba-airwave-vrf-get-buildings':
                return_results(aruba_client.building_details())
            elif demisto.command() == 'aruba-airwave-vrf-get-client-locations':
                return_results(aruba_client.client_locations(demisto.args().get("site_id")))
            elif demisto.command() == 'aruba-airwave-get-client-details':
                return_results(aruba_client.client_details(demisto.args().get("mac_address")))
            elif demisto.command() == 'aruba-airwave-vrf-get-ap-locations':
                return_results(aruba_client.ap_locations(demisto.args().get("site_id")))
            elif demisto.command() == 'aruba-airwave-get-ap-list':
                return_results(aruba_client.ap_list())
            elif demisto.command() == 'aruba-airwave-vrf-download-image':
                return_results(aruba_client.vrf_image_download(
                    demisto.args().get("image_url"), demisto.args().get("filename")))

        # Log exceptions and return errors
        except Exception as ex:
            demisto.error(traceback.format_exc())  # Show the traceback
            return_error(f'Failed to execute {demisto.command()} command.\nError:\n{str(ex)}')

    if __name__ in ('__main__', '__builtin__', 'builtins'):
        main()


    register_module_line('PANW IoT 3rd Party Integration - Aruba AirWave', 'end', __line__())
  subtype: python3
  type: python
sourcemoduleid: Aruba WLAN Controller

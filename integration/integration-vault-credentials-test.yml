category: Utilities
commonfields:
  id: vault-credentials-test
  version: -1
configuration:
- additionalinfo: Reliability of the source providing the intelligence data.
  defaultvalue: C - Fairly reliable
  display: Source Reliability
  name: integrationReliability
  options:
  - A+ - 3rd party enrichment
  - A - Completely reliable
  - B - Usually reliable
  - C - Fairly reliable
  - D - Not usually reliable
  - E - Unreliable
  - F - Reliability cannot be judged
  required: false
  section: Collect
  type: 15
- defaultvalue: https://api.xsoar-example.com
  display: Server URL (e.g., https://api.xsoar-example.com)
  name: url
  required: true
  section: Connect
  type: 0
- display: Fetch incidents
  name: isFetch
  required: false
  section: Collect
  type: 8
- display: Incident type
  name: incidentType
  required: false
  section: Connect
  type: 13
- defaultvalue: "10"
  display: Maximum number of alerts per fetch
  name: max_fetch
  required: false
  section: Collect
  type: 0
- display: ""
  displaypassword: API Key
  hiddenusername: true
  name: credentials
  required: true
  section: Connect
  type: 9
- additionalinfo: Set this to determine the HelloWorld score that will determine if
    an IP is malicious (0-100)
  advanced: true
  defaultvalue: "65"
  display: Score threshold for IP reputation command
  name: threshold_ip
  required: false
  section: Collect
  type: 0
- defaultvalue: low
  display: Severity of alerts to fetch
  name: severity
  options:
  - low
  - medium
  - high
  - critical
  required: true
  section: Collect
  type: 15
- defaultvalue: 3 days
  display: First fetch time
  name: first_fetch
  required: false
  section: Collect
  type: 0
- advanced: true
  display: Trust any certificate (not secure)
  name: insecure
  required: false
  section: Connect
  type: 8
- advanced: true
  display: Use system proxy settings
  name: proxy
  required: false
  section: Connect
  type: 8
- defaultvalue: "1"
  display: Incidents Fetch Interval
  name: incidentFetchInterval
  required: false
  type: 19
contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
description: This is the Hello World integration for getting started.
detaileddescription: |-
  ### Community Contributed Integration
   #### Integration Author: Cortex XSOAR
   No support or maintenance is provided by the author. Customers are encouraged to engage with the user community for questions and guidance at the [Cortex XSOAR Live Discussions](https://live.paloaltonetworks.com/t5/cortex-xsoar-discussions/bd-p/Cortex_XSOAR_Discussions).
  ***
  ## Hello World
  - This section explains how to configure the instance of HelloWorld in Cortex XSOAR:
  - You can use the following API Key: `dummy-key`


  ---
  [View Integration Documentation](https://xsoar.pan.dev/docs/reference/integrations/hello-world)
display: vault-credentials-test
image: data:image/png;base64,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
name: vault-credentials-test
script:
  commands:
  - arguments: []
    name: fetch-credentials
  dockerimage: demisto/python3:3.10.13.89009
  isfetch: true
  runonce: false
  script: |
    register_module_line('HelloWorld', 'start', __line__())
    ### pack version: 3.0.8



    """HelloWorld Integration for Cortex XSOAR (aka Demisto)

    This integration is a good example on you can build a Cortex XSOAR Integration
    using Python 3. Please follow the documentation links below and make sure that
    your integration follows the Code Conventions and passes the Linting phase.

    Developer Documentation: https://xsoar.pan.dev/docs/welcome
    Code Conventions: https://xsoar.pan.dev/docs/integrations/code-conventions
    Linting: https://xsoar.pan.dev/docs/integrations/linting

    When building a Cortex XSOAR integration that is reusable, a lot of effort
    must be placed in the design. We recommend to fill a Design Document template,
    that allows you to capture Use Cases, Requirements and Inputs/Outputs.

    Example Design document for the this Integration (HelloWorld):
    https://docs.google.com/document/d/1wETtBEKg37PHNU8tYeB56M1LE314ux086z3HFeF_cX0


    HelloWorld API
    --------------

    The HelloWorld API is a simple API that shows a realistic use case for an XSOAR
    integration.

    This API has a few basic functions:
    - Alerts: the endpoint returns mocked alerts and allows you to search based on
    a number of parameters, such as severity. It
    can also return a single alert by ID. This is used to create new alerts in
    XSOAR by using the ``fetch-incidents`` command, which is by default invoked
    every minute.

    - Reputation (ip): this endpoint return a WHOIS lookup of the ip given as well as a reputation score
    (from 0 to 100) that is used to determine whether the entity is malicious. This
    endpoint is called by XSOAR reputation command ``ip`` that
    is run automatically every time an indicator is extracted in XSOAR. As a best
    practice of design, it is important to map and document the mapping between
    a score in the original API format (0 to 100 in this case) to a score in XSOAR
    format (0 to 3). This score is called ``DBotScore``, and is returned in the
    context to allow automated handling of indicators based on their reputation.
    More information: https://xsoar.pan.dev/docs/integrations/dbot

    - Create Note: to demonstrate how to run commands that are not returning instant data,
    the API provides a command simulates creating a new entity in the API.
    This can be used for endpoints that take longer than a few seconds to complete with the
    GenericPolling mechanism to implement the job polling loop. The results
    can be returned in JSON or attachment file format.
    Info on GenericPolling: https://xsoar.pan.dev/docs/playbooks/generic-polling

    This integration also has a ``say-hello`` command for backward compatibility,
    that doesn't connect to an API and just returns a ``Hello {name}`` string,
    where name is the input value provided.


    Integration File Structure
    --------------------------

    An integration usually consists of the following parts:
    - Imports
    - Constants
    - Client Class
    - Helper Functions
    - Command Functions
    - Main Function
    - Entry Point


    Imports
    -------

    Here you can import Python module you need for your integration. If you need
    a module that is not part of the default XSOAR Docker images, you can add
    a custom one. More details: https://xsoar.pan.dev/docs/integrations/docker

    There are also internal imports that are used by XSOAR:
    - demistomock (imported as demisto): allows your code to work offline for
    testing. The actual ``demisto`` module is provided at runtime when the
    code runs in XSOAR.
    - CommonServerPython.py: contains a set of helper functions, base classes
    and other useful components that will make your integration code easier
    to maintain.
    - CommonServerUserPython.py: includes a set of user defined commands that
    are specific to an XSOAR installation. Do not use it for integrations that
    are meant to be shared externally.

    These imports are automatically loaded at runtime within the XSOAR script
    runner, so you shouldn't modify them

    Constants
    ---------

    Usually some constants that do not require user parameters or inputs, such
    as the default API entry point for your service, or the maximum numbers of
    alerts to fetch every time.


    Client Class
    ------------

    We recommend to use a Client class to wrap all the code that needs to interact
    with your API. Moreover, we recommend, when possible, to inherit from the
    BaseClient class, defined in CommonServerPython.py. This class already handles
    a lot of the work, such as system proxy settings, SSL certificate verification
    and exception handling for HTTP errors.

    Note that the Client class should NOT contain any Cortex XSOAR specific code,
    i.e. it shouldn't use anything in the ``demisto`` class (functions such as
    ``demisto.args()`` or ``demisto.results()`` or even ``return_results`` and
    ``return_error``.
    You will use the Command Functions to handle XSOAR inputs and outputs.

    When calling an API, you should use the ``_http.request()`` method and you
    can return the raw data to the calling function (usually a Command function).

    You should usually have one function for each API endpoint.

    Look at the code and the commends of this specific class to better understand
    the implementation details.


    Helper Functions
    ----------------

    Helper functions are usually used as utility functions that are used by several
    command functions throughout your code. For example they map arguments to types
    or convert severity formats from integration-specific to XSOAR.
    Many helper functions are already defined in ``CommonServerPython.py`` and are
    often very handy.


    Command Functions
    -----------------

    Command functions perform the mapping between XSOAR inputs and outputs to the
    Client class functions inputs and outputs. As a best practice, they shouldn't
    contain calls to ``demisto.args()``, ``demisto.results()``, ``return_error``
    and ``demisto.command()`` as those should be handled through the ``main()``
    function.
    However, in command functions, use ``demisto`` or ``CommonServerPython.py``
    artifacts, such as ``demisto.debug()`` or the ``CommandResults`` class and the
    ``Common.*`` classes.
    Usually you will have one command function for every specific XSOAR command
    you want to implement in your integration, plus ``test-module``,
    ``fetch-incidents`` and ``fetch-indicators``(if the latter two are supported
    by your integration). Each command function should invoke one specific function
    of the Client class.

    Command functions, when invoked through an XSOAR command usually return data
    using the ``CommandResults`` class, that is then passed to ``return_results()``
    in the ``main()`` function.
    ``return_results()`` is defined in ``CommonServerPython.py`` to return
    the data to XSOAR. ``return_results()`` actually wraps ``demisto.results()``.
    You should never use ``demisto.results()`` directly.

    Sometimes you will need to return values in a format that is not compatible
    with ``CommandResults`` (for example files): in that case you must return a
    data structure that is then pass passed to ``return.results()``.

    In any case you should never call ``return_results()`` directly from the
    command functions.

    When you use create the CommandResults object in command functions, you
    usually pass some types of data:

    - Human Readable: usually in Markdown format. This is what is presented to the
    analyst in the War Room. You can use ``tableToMarkdown()``, defined in
    ``CommonServerPython.py``, to convert lists and dicts in Markdown and pass it
    to ``return_results()`` using the ``readable_output`` argument, or the
    ``return_results()`` function will call ``tableToMarkdown()`` automatically for
    you.

    - Context Output: this is the machine readable data, JSON based, that XSOAR can
    parse and manage in the Playbooks or Incident's War Room. The Context Output
    fields should be defined in your integration YML file and is important during
    the design phase. Make sure you define the format and follow best practices.
    You can use ``demisto-sdk json-to-outputs`` to autogenerate the YML file
    outputs section. Context output is passed as the ``outputs`` argument in ``demisto_results()``,
    and the prefix (i.e. ``HelloWorld.Alert``) is passed via the ``outputs_prefix``
    argument.

    More information on Context Outputs, Standards, DBotScore and demisto-sdk:
    https://xsoar.pan.dev/docs/integrations/code-conventions#outputs
    https://xsoar.pan.dev/docs/integrations/context-and-outputs
    https://xsoar.pan.dev/docs/integrations/context-standards
    https://xsoar.pan.dev/docs/integrations/dbot
    https://github.com/demisto/demisto-sdk/blob/master/demisto_sdk/commands/json_to_outputs/README.md

    Also, when you write data in the Context, you want to make sure that if you
    return updated information for an entity, to update it and not append to
    the list of entities (i.e. in HelloWorld you want to update the status of an
    existing ``HelloWorld.Alert`` in the context when you retrieve it, rather than
    adding a new one if you already retrieved it). To update data in the Context,
    you can define which is the key attribute to use, such as (using the example):
    ``outputs_key_field='alert_id'``. This means that you are using the ``alert_id``
    key to determine whether adding a new entry in the context or updating an
    existing one that has the same ID. You can look at the examples to understand
    how it works.
    More information here:
    https://xsoar.pan.dev/docs/integrations/context-and-outputs
    https://xsoar.pan.dev/docs/integrations/code-conventions#outputs
    https://xsoar.pan.dev/docs/integrations/dt

    - Raw Output: this is usually the raw result from your API and is used for
    troubleshooting purposes or for invoking your command from Automation Scripts.
    If not specified, ``return_results()`` will use the same data as ``outputs``.


    Main Function
    -------------

    The ``main()`` function takes care of reading the integration parameters via
    the ``demisto.params()`` function, initializes the Client class and checks the
    different options provided to ``demisto.commands()``, to invoke the correct
    command function passing to it ``demisto.args()`` and returning the data to
    ``return_results()``. If implemented, ``main()`` also invokes the function
    ``fetch_incidents()``with the right parameters and passes the outputs to the
    ``demisto.incidents()`` function. ``main()`` also catches exceptions and
    returns an error message via ``return_error()``.


    Entry Point
    -----------

    This is the integration code entry point. It checks whether the ``__name__``
    variable is ``__main__`` , ``__builtin__`` (for Python 2) or ``builtins`` (for
    Python 3) and then calls the ``main()`` function. Just keep this convention.

    """
    import json
    from typing import Any

    import dateparser



    def main() -> None:  # pragma: no cover
        """
        main function, parses params and runs command functions
        """
        demisto.credentials([{"name": "admin", "password": "123", "user": "Joe"}])



    ''' ENTRY POINT '''

    if __name__ in ('__main__', '__builtin__', 'builtins'):
        main()

    register_module_line('HelloWorld', 'end', __line__())
  subtype: python3
  type: python
sourcemoduleid: HelloWorld

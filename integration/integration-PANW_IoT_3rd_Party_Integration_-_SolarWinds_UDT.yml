category: Network Security
commonfields:
  id: PANW IoT 3rd Party Integration - SolarWinds UDT
  version: -1
configuration:
- additionalinfo: SolarWinds Orion URL
  display: Server URL
  name: server_url
  required: true
  type: 0
- display: Username
  name: username
  required: true
  type: 0
- display: Password
  name: password
  required: true
  type: 4
contentitemexportablefields:
  contentitemfields:
    definitionid: ""
    fromServerVersion: ""
    itemVersion: ""
    packID: ""
    packName: ""
    prevname: ""
    propagationLabels:
    - all
    toServerVersion: ""
description: SolarWinds Orion Platform Integration
detaileddescription: |-
  ## SolarWinds Orion Platform integration

  Please configure the instance by providing following details:

  - Name of the instance
  - SolarWinds Orion IP or Hostname
  - User name for log in
  - Password associated with the user account

  ## Test Configuration

  After providing the mandatory details, please test the configuration using the Test button.

  ---
display: PANW IoT 3rd Party Integration - SolarWinds Orion
image: data:image/png;base64,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
name: PANW IoT 3rd Party Integration - SolarWinds UDT
script:
  commands:
  - arguments:
    - name: page_length
    - name: offset
    description: Fetch all networking devices (switches, routers, access points, etc)
      from the SolarWinds Orion platform
    name: swis_get_orion_nodes
  - arguments:
    - name: page_length
    - name: offset
    description: Fetch all wired endpoints from the SolarWinds Orion platform
    name: swis_get_wired_endpoints
  - arguments:
    - name: offset
    - name: page_length
    description: Fetch all wireless endpoints from the SolarWinds Orion platform
    name: swis_get_wireless_endpoints
  - arguments:
    - name: page_length
    - name: offset
    description: Fetch all ipam subnets from the SolarWinds Orion Platform
    name: swis_get_ipam_subnets
  dockerimage: demisto/panw-iot:1.0.0.97312
  runonce: false
  script: |
    register_module_line('PANW IoT 3rd Party Integration - SolarWinds UDT', 'start', __line__())




    import orionsdk
    import urllib3
    from typing import Dict, List, Callable, Tuple

    # Disable insecure warnings
    urllib3.disable_warnings()


    SERVER = demisto.params().get("server_url")
    SERVER = SERVER.lstrip("https://")
    USERNAME = demisto.params().get("username")
    PASSWD = demisto.params().get("password")

    def run_swql_query(query):
        swis = orionsdk.SwisClient(SERVER, USERNAME, PASSWD, verify=False) # TODO. Add cert support later
        res = swis.query(query)
        return res

    def get_orion_nodes_cmd():
        offset = demisto.args().get("offset")
        page_length = demisto.args().get("page_length") # Add Null check here
        get_all_nodes_query = """ SELECT NodeID,
        IPAddress, IPAddressType, DisplayName, NodeDescription, Description, DNS,
        SysName, Vendor, Location, IOSImage, IOSVersion, SystemUpTime, CPUCount,
        CPULoad, MemoryUsed, MemoryAvailable, PercentMemoryUsed,
        PercentMemoryAvailable, LastSync, MachineType,
        IsServer, Community, IP, IP_Address,
        NodeName FROM Orion.Nodes ORDER BY NodeID WITH ROWS %s to %s
        """ % (offset, str(int(offset) + int(page_length)))
        return run_swql_query(get_all_nodes_query)

    def get_orion_wired_endpoints_cmd():
        offset = demisto.args().get("offset")
        page_length = demisto.args().get("page_length")
        get_all_endpoints_query = """
        SELECT  IPAddress, MACAddress, ConnectedTo, PortNumber,
        ConnectionType, ConnectionTypeName, HostName,  MACVendor,
        PortName, PortID, NodeID, VLAN
        FROM Orion.UDT.AllEndpoints ORDER BY ConnectionTypeName WITH ROWS %s to %s
        """ % (offset, str(int(offset) + int(page_length)))
        return run_swql_query(get_all_endpoints_query)

    def get_orion_wireless_endpoints_cmd():
        offset = demisto.args().get("offset")
        page_length = demisto.args().get("page_length")
        get_all_wireless_endpoints_query = """
        SELECT AccessPoint, APID, Caption, DNSName,
        IPAddress, MACAddress, MACVendor, NodeID, SSID, VendorIcon
        FROM Orion.UDT.AllWirelessEndpoints ORDER BY MACAddress WITH ROWS %s to %s
        """ % (offset, str(int(offset) + int(page_length)))
        return run_swql_query(get_all_wireless_endpoints_query)

    def get_orion_ipam_subnets_cmd():
        offset = demisto.args().get("offset")
        page_length = demisto.args().get("page_length")
        get_ipam_subnets_query = """
        SELECT SubnetId, ParentId, Address, AddressN, AddressMask, CIDR,
        AllocSize, AllocSizeN, FriendlyName, Comments, VLAN, Location,
        LastDiscovery, Status, ScanInterval, PercentUsed, TotalCount,
        UsedCount, AvailableCount, ReservedCount, TransientCount,
        HasLicenceOverflow, GroupIconPrefix, StatusName, StatusShortDescription,
        StatusRanking, StatusIconPostfix, GroupTypeText, AccountID, Role, GroupType,
        Distance, SubnetStructureChanged FROM IPAM.Subnet ORDER BY SubnetId WITH ROWS %s to %s
        """ % (offset, str(int(offset) + int(page_length)))
        return run_swql_query(get_ipam_subnets_query)

    def test_connection():
        query = "SELECT TOP 1 NodeID from Orion.Nodes"
        res = run_swql_query(query)
        if "NodeID" in res['results'][0]:
            return 'ok'
        else:
            return "Failed to run test-command"


    def main() -> None:
        try:
            command = demisto.command()
            if command == "test-module":
                return_results(test_connection())
            elif command == "swis_get_orion_nodes":
                return_results(get_orion_nodes_cmd())
            elif command == "swis_get_wired_endpoints":
                return_results(get_orion_wired_endpoints_cmd())
            elif command == "swis_get_wireless_endpoints":
                return_results(get_orion_wireless_endpoints_cmd())
            elif command == "swis_get_ipam_subnets":
                return_results(get_orion_ipam_subnets_cmd())
            # Log exceptions and return errors
        except Exception as e:
            return_error(f'Failed to execute {demisto.command()} command.\nError:\n{str(e)}')

    ''' ENTRY POINT '''

    if __name__ in ('__main__', '__builtin__', 'builtins'):
        main()



    register_module_line('PANW IoT 3rd Party Integration - SolarWinds UDT', 'end', __line__())
  subtype: python3
  type: python
sourcemoduleid: Solarwinds UDT
